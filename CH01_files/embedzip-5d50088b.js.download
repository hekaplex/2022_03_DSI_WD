define("@ms/odsp-utilities/lib/string/DriveSpaceHelper",["require","exports","@ms/items-view-utilities/lib/string/DriveSpaceHelper.resx","../locale/Locale"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=1.2.toLocaleString(r.default.language).replace(/\d+/g,""),o=/\.?0+$/;(function(e){e.getDisplayString=function(e,r){void 0===r&&(r={});if("number"!=typeof e||isNaN(e)||r.ignoreZero&&0===e||e<0)return"";var i=r.trimDecimal;return 1===e?n.default.fileSizeBytesSingular:e<1024?t(n.default.fileSizeBytesPlural,e,i):e<1024e3?t(n.default.fileSizeKB,e/1024,i):e<1048576e3?t(n.default.fileSizeMB,e/1048576,i):e<0xfa00000000?t(n.default.fileSizeGB,e/1073741824,i):t(n.default.fileSizeTB,e/1099511627776,i)};function t(e,t,n){return e.replace("{0}",(function(e,t){if(e>=100||e===Math.floor(e))return e.toFixed(0);var n=e.toFixed(e>=10?1:2);return(t?n.replace(o,""):n).replace(".",s)})(t,n))}})(i||(i={}));t.default=i});
define("odsp-next/controls/oneUp/zip/OneUpZip",["require","exports","./OneUpZip.html","./OneUpZipViewModel","../../../bindings/component/ControlBinding","EmbedZip_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=void 0;t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-zip",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/zip/OneUpZip.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:showError--\x3e<section class="od-OneUpZip-container"><div class="od-OneUpZip-header" role="heading"><img class="od-OneUpZip-image" data-bind="attr:{src:svgUrl,alt:altText}"><span class="od-OneUpZip-number" data-bind="text:totalNum"></span></div><div class="od-OneUpZip" role="presentation" data-is-scrollable="true" data-bind="react:zipList"></div>\x3c!--ko if:isPartial()--\x3e<div class="od-OneUpZip-partial" role="alert"><span data-bind="text:beforeLinkText"></span><a href="javascript:;" data-bind="attr:{title:zipName},click:downloadZipFromPreview,text:linkText"></a><span data-bind="text:afterLinkText"></span></div>\x3c!--/ko--\x3e</section>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/zip/OneUpZipViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../../../bindings/react/ReactBinding","../OneUpContentViewModel","../other/OneUpOther","./commandSets/DownloadZipContentsCommandSet","./OneUpZip.resx","../../../providers/engagement/Engagement","../../../resources/DataSourceResourceKeys","../../../resources/ControlResourceKeys","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(t){n.__extends(g,t);function g(s,f){var c=t.call(this,s,f)||this;c._engagement=f.engagement;c._countOnSelect=0;c._isRetinaEnabled=f.platformDetection.isRetinaSupported;c.altText=h.default.zipAltText;c._downloadAction=new(c.managed(f.actionMap.DownloadAction))({item:s.slide.item});var p=c.observables,d=h.default.downloadUrlTextLink.split("{0}"),v=d[0],m=d[1];c.beforeLinkText=v;c.afterLinkText=m;c.linkText=h.default.downloadUrlText;c.addBindingHandlers({control:u.default,react:a.default});var g=s.slide;c.fallbackControl=u.toSpecification(l.default,n.__assign(n.__assign({},s),{slide:n.__assign(n.__assign({},g),{loadResult:p.createCallback(r.forSingleValue())})}));var y=p.create();c.scope.attach(g.loadResult.register(y));c.isPartial=p.create(!1);c.showError=p.create(!1);c.totalNum=p.create("");c._selectedZipItems=p.create([]);c._downloadUrl=p.pureCompute(function(){var e=g.item();return e&&e.zip&&e.zip.downloadZipContentsUrl});c.zipName=p.pureCompute(function(){var e=g.item();return e&&e.name});c.svgUrl=window.require.toUrl("odsp-media/images/oneupzip/zipicon.svg");var b=g.item.peek(),w=c._root=p.create({children:[],date:b&&b.dateModified||"",extension:b&&b.extension||"",isFolder:!0,name:b&&b.name||"",childCount:0,parentFolder:void 0,path:"",size:0});c._onNavigate=c._onNavigate.bind(c);c._onSelect=c._onSelect.bind(c);c.zipList={componentPath:"../../zip/react/ZipContentList",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["../../zip/react/ZipContentList"],t,n)}))},props:p.pureCompute(c._computeZipListProps)};c._logZipEvent("ZipPreviewByClick",1);var E=f.zipDataSource;p.backgroundCompute(function(){var e=g.item(),t=e.zip&&e.zip.zipMetaDataUrl;E.getContents(e,t).then(function(e){w(e.root);c.totalNum(e.root.childCount);if(""!==e.error){c._logZipEvent("MoreThan1000Files",1);c.isPartial(!0)}y({resultType:o.ResultTypeEnum.Success});g.loadState(3)},function(e){y({resultType:e.isExpected?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure,resultCode:e.code||"GetContents",error:e&&e.message||""+e});g.loadState(3);c.showError(!0)})});return c}g.prototype.downloadZipFromPreview=function(e){this._downloadAction.execute(e)};g.prototype._computeZipListProps=function(){return{allowSelection:!m.isFeatureEnabled(m.DisableZipContentDownload)&&!this.slide.renderOptions,root:this._root(),name:this.zipName(),onNavigate:this._onNavigate,onSelect:this._onSelect,isRetinaEnabled:this._isRetinaEnabled}};g.prototype._onNavigate=function(e){this.totalNum(e.childCount);this._logZipEvent("ZipFolderNavigation",this._countOnSelect);this._countOnSelect++;this._onSelect([],e)};g.prototype._onSelect=function(e,t){this._selectedZipItems(e.length>0?e:[t]);var n=t===this._root.peek()&&t.childCount===e.length;if(0!==e.length&&!n||t&&t.path){this._zipCommandSet||this._initZipCommandSet();this.slide.commandSet(this._zipCommandSet)}else this.slide.commandSet(void 0)};g.prototype._initZipCommandSet=function(){this._zipCommandSet=new(this.managed(c.default))({actionParams:{item:this.slide.item,selection:this._selectedZipItems,url:this._downloadUrl}})};g.prototype._logZipEvent=function(e,t){0!==t&&this._engagement.logData({name:"OneUpZipPreviewer."+e})};g.dependencies=n.__assign(n.__assign({},f.default.dependencies),{actionMap:v.actionMap,engagement:p.resourceKey,platformDetection:s.platformDetection,zipDataSource:d.zip});return g})(f.default);t.default=g});
define("odsp-next/controls/oneUp/zip/commandSets/DownloadZipContentsCommandSet",["require","exports","tslib","../../../commands/BaseCommandSet","../../../commands/Command","../../../../utilities/icons/Icon","../../../commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(u.actionMap);a.isFeatureEnabled(a.DisableZipContentDownload)||n.commands.push(new(n.managed(i.CommandViewModel))({icon:new s.default("Download"),text:o.default.Download,automationId:"OneUpZipDownload",action:new(n.managed(r.DownloadZipContentsAction))(t.actionParams)}));return n}return t})(r.default);t.default=f});
define("odsp-next/controls/zip/react/ZipContentList",["require","exports","tslib","react","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Breadcrumb","office-ui-fabric-react/lib/DetailsList","office-ui-fabric-react/lib/Fabric","office-ui-fabric-react/lib/Link","../ZipContent.resx","../../breadcrumbBar/BreadcrumbBar.resx","../../../models/item/Item.resx","../../../utilities/icons/IconHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ZipContentList=void 0;var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.root;n._onItemInvoked=n._onItemInvoked.bind(n);n._onBreadcrumbClick=n._onBreadcrumbClick.bind(n);n._columns=n._getAllColumns();n.state={ancestors:[r],crumbs:n._appendBreadcrumb([],r.name)};var i=n._selection=new a.Selection({selectionMode:a.SelectionMode.single,onSelectionChanged:function(){var e=n.state.ancestors;n.props.onSelect(i.getSelection(),e[e.length-1])}});i.setItems(r.children,!0);return n}t.prototype.render=function(){var e=!!this.props.allowSelection,t=this.state.ancestors,n=this.state.crumbs.reduce(function(e,t){return e?o.format(h.default.breadCrumbItem,t.text,e):t.text},""),i=t[t.length-1].childCount,s=o.format(o.getLocalizedCountValue(c.default.zipAriaLabel,c.default.zipAriaLabelIntervals,i),i);return r.createElement(f.Fabric,null,r.createElement(u.Breadcrumb,{ariaLabel:o.format(h.default.breadCrumbNavigation,n),items:this.state.crumbs,maxDisplayedItems:5}),r.createElement(a.DetailsList,{items:t[t.length-1].children,columns:this._columns,checkboxVisibility:e?a.CheckboxVisibility.onHover:a.CheckboxVisibility.hidden,selectionMode:e?a.SelectionMode.multiple:a.SelectionMode.none,layoutMode:a.DetailsListLayoutMode.fixedColumns,onItemInvoked:this._onItemInvoked,selection:this._selection,constrainMode:a.ConstrainMode.horizontalConstrained,selectionPreservedOnEmptyClick:!0,ariaLabel:s}))};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;this.props!==e&&e.root!==this.props.root&&this.setState(function(e,n){var r=n.root;t._selection.setItems(r.children,!0);return{ancestors:[r],crumbs:t._appendBreadcrumb([],r.name)}})};t.prototype._onItemInvoked=function(e){var t=this;e.isFolder&&this.setState(function(r){var i=r.crumbs,s=i.length;t._selection.setItems(e.children,!0);t.props.onNavigate(e);return{ancestors:r.ancestors.concat([e]),crumbs:t._appendBreadcrumb(n.__spreadArrays(i.slice(0,-1),[n.__assign(n.__assign({},i[s-1]),{isCurrentItem:!1})]),e.name)}})};t.prototype._onBreadcrumbClick=function(e,t){var n=this,r=parseInt(t.key,10);this.setState(function(e){var t=e.ancestors[r];n._selection.setItems(t.children,!0);n.props.onNavigate(t);return{ancestors:e.ancestors.slice(0,r+1),crumbs:n._appendBreadcrumb(e.crumbs.slice(0,r),t.name)}})};t.prototype._appendBreadcrumb=function(e,t){var r=e.length;return n.__spreadArrays(e,[{text:t,key:""+r,isCurrentItem:!0,onClick:this._onBreadcrumbClick}])};t.prototype._getAllColumns=function(){return[{key:"zipIcon",fieldName:null,minWidth:20,maxWidth:20,name:null,onRender:m.bind(this)},{key:"zipName",fieldName:null,isResizable:!0,minWidth:200,name:c.default.columnNameName,onRender:g.bind(this,"name")},{key:"zipDateModified",fieldName:null,isCollapsable:!0,isResizable:!0,minWidth:100,name:c.default.columnNameDateModified,onRender:g.bind(this,"date")},{key:"zipFileSize",fieldName:null,isCollapsable:!0,isResizable:!0,minWidth:100,name:c.default.columnNameSize,onRender:function(e,t,n){return r.createElement("div",null,e.size?s.default.getDisplayString(e.size,{ignoreZero:!0}):"")}}]};return t})(r.Component);t.ZipContentList=v;function m(e,t,n){if(e){var s=e.extension,u=e.isFolder?"folder":i.getIconNameFromExtension(s),a=s&&"."===s[0]?s.slice(1):s,f=d.getIconUrlRetina(this.props.isRetinaEnabled,u,20);return r.createElement("img",{src:f,style:{width:"20px",height:"20px"},title:e.isFolder?p.default.fileTypeFolder:o.format(p.default.fileTypeUnknown,a)})}}function g(e,t,n,i){var s=this;if(t)return"name"===e&&!0===t.isFolder?r.createElement(l.Link,{onClick:function(){return s._onItemInvoked(t)}},t[e]):r.createElement("div",null,t[e])}t.default=v});
define('EmbedZip_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-OneUpZip-container{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";height:95%}.od-OneUpZip-container .ms-Breadcrumb{margin-bottom:20px}.od-OneUpZip-header{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.od-OneUpZip-image{height:130px;width:135px}.od-OneUpZip-number{position:absolute;top:83px;font-size:medium;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";width:113px}html[dir=ltr] .od-OneUpZip-number{text-align:right}html[dir=rtl] .od-OneUpZip-number{text-align:left}.od-OneUpZip{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding:0 20px;overflow:auto}.od-OneUpZip .od-Link{cursor:pointer;text-decoration:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-OneUpZip .ms-DetailsRow-cell .ms-Link{font-size:12px}.od-OneUpZip .ms-DetailsRow-cell .ms-Link:hover{text-decoration:underline;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-OneUpZip-partial{height:30px;background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";text-align:center;padding:19px 0 9px;font-size:14px}"}]);});