webpackJsonp([20],{135:function(e,t,n){"use strict";function r(e,t){var n=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.searchable&&t||n.push({Address:e.address})}),n}function i(e,t){if(t){var n=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){e.searchable&&n.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),n}var r=[];return e.phones&&e.phones.length>0&&e.phones.forEach(function(e){return r.push({PhoneNumber:e.number,PhoneUrl:"tel:"+e.number,Type:e.type})}),e.telephoneNumber&&r.push({PhoneNumber:e.telephoneNumber,PhoneUrl:"tel:"+e.telephoneNumber,Type:"Business"}),r}var a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(57);t.getDirectReportsAndManager=function(e){return{Managers:e.filter(function(e){return 1===e.managerLevel}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}}),Directs:e.filter(function(e){return!e.userClassification}).map(function(e){return{DisplayName:e.displayName,Smtp:e.smtpAddresses[0],Department:e.department,JobTitle:e.jobTitle}})}},t.getVisibleEmails=function(e){var t=[];return e.emailsInfo&&e.emailsInfo.forEach(function(e){!e.address||e.visibility&&e.visibility!=s.AliasVisibility.Public||t.push({Address:e.address})}),t},t.getVisiblePhones=function(e){var t=[];return e.phonesInfo&&e.phonesInfo.forEach(function(e){!e.number||e.visibility&&e.visibility!=s.AliasVisibility.Public||t.push({PhoneNumber:e.number,Type:"Home",PhoneUrl:"tel:"+e.number})}),t},t.getEmails=r,t.getEmail=function(e,t){if(!t)return e.email?{Address:e.email}:void 0;var n=r(e,t);return n.length>0?n[0]:void 0},t.getPhoneNumbers=i,t.getPhoneNumber=function(e,t){if(t){var n=i(e,t);if(n.length>0){var r=n[0];return{number:r.PhoneNumber,type:r.Type,url:r.PhoneUrl}}}else{if(e.telephoneNumber)return{number:e.telephoneNumber,type:"Business",url:"tel:"+e.telephoneNumber};if(e.phones&&e.phones.length>0){var a=e.phones[0];return{number:a.number,type:a.type,url:"tel:"+a.number}}}},t.removeZeroWidthSpace=function(e){var t=/[\u200B-\u200D\uFEFF]/g;return e.replace(t,"")},t.getPersonaProfileByContactId=function(e,t,n,r,i){return a(this,void 0,void 0,function(){var a,s,c;return o(this,function(o){switch(o.label){case 0:return e?[4,n.getCachedExchangeContactById(e)]:[3,2];case 1:return(s=o.sent())?a=[{displayName:n.getDisplayNameForUserContact(s),id:s.id,jobTitle:s.jobTitle,mri:s.mri,phones:s.phones,email:s.emails[0]||"",objectId:s.id}]:(c="No profile returned for exchange contact",t.error("getCachedExchangeContactById returned no profile in LPC {0}",i),r.fail({reason:c})),[3,3];case 2:c="Empty OlsPersonaId to look for Exchange contact profile",t.error("Empty OlsPersonaId to look for Exchange contact profile in LPC {0}",i),r.fail({reason:c}),o.label=3;case 3:return a&&r.mark(i),[2,a]}})})},t.getIsMixedChatUser=function(e,t){var n=e&&"Federated"===t||!e&&"TflConsumer"===t;return Boolean(n)}},2293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2294)},2294:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2295),c=n(57),l=n(311),u=n(2296),p=n(2298),f=n(2299),d=n(2300),h=n(2304),v=function(e){function t(t,n,r,i,a,o,s,c,l,u,p,f,d,h){var v=e.call(this,l)||this;return v.constants=t,v.utilityService=n,v.settingsService=r,v.authenticationService=i,v.sxConfig=a,v.localizationService=o,v.eventingService=s,v.appStateService=c,v.loggingService=u,v.logger=p,v.actionCallbacks=f,v.dataCallbacks=d,v.telemetryCallbacks=h,v.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(v.getTheme(e))},v.initializeOnAppLaunchAndReinit("First Initialize"),v}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.lpcPromise=null,window.LPC=null,this.unbsubscribeFromAppStateChanges&&(this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=null)},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.unbsubscribeFromAppStateChanges&&this.unbsubscribeFromAppStateChanges(),this.unbsubscribeFromAppStateChanges=this.eventingService.unsafeOnWithTenantScope(this.constants.events.appState.changed,function(e,n){t.onAppStateChanged(n)})},t.prototype.initializeLPC=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,c,u,p,f,d,h,v,g,m,y,b,S,C,P,k,w,T,A,I,L,O,x,E;return o(this,function(o){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];if(e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,a=this.settingsService.valueFor(this.constants.settings.names.lpcComplianceEnvironment),c="Prod"!==a,u=this.settingsService.isInternalRing()&&!c,p=this.authenticationService.getUserTypeInTenant(),f=this.sxConfig.getCurrentSkypeMri(),d=p===teamspace.services.UserTypeInTenant.Guest,h=this.settingsService.valueAsBoolean(this.constants.settings.names.enableTimeZoneInLPC),v=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePronounsInLPC),g=this.settingsService.valueAsBoolean(this.constants.settings.names.enablePeopleHighlightsInLPC),m=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNextAvailabilityInLPC),y=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAliasVisibilitySettings),b=l.isLinkedInEnabled(this.settingsService,this.constants),S=u&&!d?"df":"",!this.appStateService.isOnline)throw E="App is Offline",e.fail({message:E,clientCorrelationId:t,lpcRegion:S,userTypeInTenant:p}),new Error(E);C=this.getTeamsConfig(t,n,S,a),P=this.settingsService.getRing(),k=this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCardV2),w={isLivePersonaCardV2Enabled:k},T=l.getTimeFormat(this.localizationService),A=T[0],I=T[1],this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return L=P&&P.id?P.id:void 0,O=r,this.lpcPromise=s.initializeLivePersonaCardAsync(i(i({},C),{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,telemetryCallbacks:this.telemetryCallbacks,getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:L,hostAppVersion:O,options:{hostAppRing:L,hostAppVersion:O,isLoggedInAsTeamsGuestUser:d,isTimeZoneEnabled:h,isPronounsEnabled:v,isPeopleHighlightsEnabled:g,isNextAvailabilityEnabled:m,isAliasVisibilityEnabled:y,isLinkedInEnabledInHostApp:b,is24HourFormat:I,timeFormat:A},hostAppConfiguration:w,loggedInUserTeamsMri:f})),x=k?"LPCv2":"LPCv1",this.lpcPromise.then(function(){var n=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:n,clientCorrelationId:t,lpcRegion:S,userTypeInTenant:p,lpcArchitectureVersion:x})}).catch(function(n){throw e.fail({message:"Could not load LivePersonaCard",clientCorrelationId:t,lpcRegion:S,userTypeInTenant:p,lpcArchitectureVersion:x}),n}),[2,this.lpcPromise]}catch(n){throw E="Could not load live persona card: "+n,e.fail({message:E,clientCorrelationId:t,lpcRegion:S,userTypeInTenant:p}),new Error(E)}return[2]})})},t.prototype.createLPC=function(e,t){var n=t.profile,r=t.behavior,a=t.ariaLabel,o=t.externalAppSessionCorrelationId,s=t.disableAccessibilityDefaults,c=t.tabIndex,u=t.clientScenario,p=t.isSharedChannel,f=t.hostTenantId,d=t.hostConversationId,h=t.isExchangeOnlyContact,v=t.contactId;{if(this.isLivePersonaCardInitialized){var g=l.determineLPCPersonaType(n.role,n.type),m=l.getCleanUpn(n.userPrincipalName),y={personaInfo:{identifiers:{PersonaType:g,AadObjectId:n.objectId,TeamsMri:n.mri,OlsPersonaId:v,HostAppPersonaId:l.serializeHostAppPersonaId({userId:n.mri,isSharedChannel:p,hostTenantId:f,hostConversationId:d,isExchangeOnlyContact:h}),Upn:m,Smtp:n.email},skypeId:n.skypeId},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},r),ariaLabel:a,disableAccessibilityDefaults:!!s,tabIndex:c,externalAppSessionCorrelationId:o,clientScenario:u};this.attachHoverTargetAsync(e,y);var b=function(){window.requestIdleCallback&&window.requestIdleCallback(function(){window.LPC&&window.LPC.removedPersonaFromPage(e)})}.bind(this);return{destroy:function(){b()}}}this.logger.error("Not initialized")}},t.prototype.onAppStateChanged=function(e){var t=e.prevState,n=t===teamspace.services.ApplicationState.Offline||t===teamspace.services.ApplicationState.Disconnected||t===teamspace.services.ApplicationState.Disabled,r=this.appStateService.isOnline&&n,i=this.settingsService.valueAsBoolean(this.constants.settings.names.disableLpcOnlineRecovery);!r||i||this.isLivePersonaCardInitialized||(s.freeBootstrapperMemory(window),this.initializeLPC())},t.prototype.attachHoverTargetAsync=function(e,t){window.LPC.addedPersonaToPageV2(e,t)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Dark:case c.LpcTheme.DarkV2:return d.darkTheme;case c.LpcTheme.HighContrast:return d.highContrastTheme;case c.LpcTheme.Default:case c.LpcTheme.DefaultV2:default:return d.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n,r){var i=this.authenticationService.isCurrentUserTFLOrMsaAccount();return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:r,options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1},isConsumer:i}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return a(t,void 0,void 0,function(){var t,i,a,s,c,l,u,p,f,d,h,v,g,m,y,b;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this.constants.settings.names,i=t.lokiTokenResourceUrl,a=t.enableSilentLokiAuthTokenRetrieval,s=this.settingsService.valueAsBoolean(a),[4,this.authenticationService.getAuthTokens([this.settingsService.valueFor(i)],[],s)];case 1:return(c=o.sent())?("string"!=typeof c&&(l=c,u=Boolean(l.token)?"true":"false",this.logger.service.event("lokitoken_format_workaround",{data:"ContainedToken:"+u}),c=null!==(b=l.token)&&void 0!==b?b:""),n(c,e)):r("[AuthError] Error retrieving auth token, details: Empty token",e),[3,3];case 2:return p=o.sent(),this.logger.error("Error acquiring access token for LOKI"),f=!1,d="Unexpected Error",h=void 0,p&&(h=_.isString(p)?p:p.authStatus+"-"+p.message,h=h.toLowerCase()),h&&(v=h.includes("retry fetch of adal tokens"),g=h.includes("nativewam:3")||h.includes("tokenrevoked"),m=h.includes("mt_token_expired")||h.includes("receivedexpiredtoken"),y=h.includes("renewaltimeout")||h.includes("token renewal"),f=v||y||m||g,v?d="Retry fetch of ADAL tokens failed":y?d="Token renewal call timed out":g?d="Token revoked":m&&(d="Token expired")),r("[AuthError] Error retrieving auth token, details: "+d,e,f),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=v,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.dialogService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsAsyncService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","messagingPolicySettingsStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsAsyncService","localizationService","eventingService","messageService","peopleService","dialogService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService","callBlockingService","appStateService","sxConfig","routeUtilityService","messagingPolicyUtilsService","flatContactListService","telemetryProvider","chatListService",function(e,t,n,r,i,a,o,s,c,l,d,g,m,y,b,S,C,P,k,w,T,A,I,L,O,x,E,M,U,F,_,j,D,N,B){var R=a.newLogger("LivePersonaCardService"),G=new h.LpcTelemetryHelper(E,a,l),H=G.logPanelActionEvent.bind(G),V=o.getUserTypeInTenant(),z=u.LPCActionCallbackFactory(s,e,R,y,l,o,c,S,m,M,b,i,B,H),X=p.LPCDataCallbackFactory(R,l,C,y,r,P,k,i,e,w,T,A,I,L,d,O,M,t,n,V,F,o,_,j,D),W=i.valueAsBoolean(e.settings.names.enableLpcSecondPartyTelemetry)?f.LPCTelemetryCallbackFactory(N):void 0;return new v(e,r,i,o,F,d,g,U,x,a,R,z,X,W)}])},2295:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);l.length;)l.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"loggingdependencies",2:"vendors~loggingdependencies"}[e]||e)+"_"+{0:"1ce2ea2bbd5eceb043b3",2:"58a9bd5d70dd9db494af"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var l=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://res-1.cdn.office.net/midgard/versionless/",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;return n(n.s=13)}([function(e,t,n){"use strict";t.a={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},function(e,t,n){"use strict";var r=n(2),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.a||i||Function("return this")();t.a=a},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(12))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return a.indexOf(e)>-1}function i(e){return-1===o.indexOf(e)}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var a=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],o=["Stikkontakt","DataLoadStartAction","NoLogging","None"]},function(e,t,n){"use strict";t.a={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},function(e,n,r){"use strict";(function(e){var i=r(2),a="object"==typeof t&&t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a&&i.a.process,c=function(){try{return o&&o.require&&o.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(9)(e))},function(e,t,n){"use strict";function r(e,t){return e.hasOwnProperty(t)}n.d(t,"a",function(){return r});var i,a=n(1),o=a.a.Symbol,s=Object.prototype,c=s.hasOwnProperty,l=s.toString,u=o?o.toStringTag:void 0,p=function(e){var t=c.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var i=l.call(e);return r&&(t?e[u]=n:delete e[u]),i},f=Object.prototype.toString,d=function(e){return f.call(e)},h=o?o.toStringTag:void 0,v=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?p(e):d(e)},g=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},m=function(e){if(!g(e))return!1;var t=v(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},y=a.a["__core-js_shared__"],b=(i=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",S=function(e){return!!b&&b in e},C=Function.prototype.toString,P=function(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""},k=/^\[object .+?Constructor\]$/,w=Function.prototype,T=Object.prototype,A=w.toString,I=T.hasOwnProperty,L=RegExp("^"+A.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=function(e){return!(!g(e)||S(e))&&(m(e)?L:k).test(P(e))},x=function(e,t){return null==e?void 0:e[t]},E=function(e,t){var n=x(e,t);return O(n)?n:void 0},M=function(){try{var e=E(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),U=function(e,t,n){"__proto__"==t&&M?M(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},F=function(e,t){return e===t||e!=e&&t!=t},_=Object.prototype.hasOwnProperty,j=function(e,t,n){var r=e[t];_.call(e,t)&&F(r,n)&&(void 0!==n||t in e)||U(e,t,n)},D=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?U(n,s,c):j(n,s,c)}return n},N=function(e){return e},B=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},R=Math.max,G=function(e,t,n){return t=R(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=R(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),B(e,this,s)}},H=function(e){return function(){return e}},V=M?function(e,t){return M(e,"toString",{configurable:!0,enumerable:!1,value:H(t),writable:!0})}:N,z=Date.now,X=function(e){var t=0,n=0;return function(){var r=z(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(V),W=function(e,t){return X(G(e,t,N),e+"")},q=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Q=function(e){return null!=e&&q(e.length)&&!m(e)},J=/^(?:0|[1-9]\d*)$/,K=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&J.test(e))&&e>-1&&e%1==0&&e<t},$=function(e,t,n){if(!g(n))return!1;var r=typeof t;return!!("number"==r?Q(n)&&K(t,n.length):"string"==r&&t in n)&&F(n[t],e)},Z=Object.prototype,Y=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)},ee=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},te=function(e){return null!=e&&"object"==typeof e},ne=function(e){return te(e)&&"[object Arguments]"==v(e)},re=Object.prototype,ie=re.hasOwnProperty,ae=re.propertyIsEnumerable,oe=ne(function(){return arguments}())?ne:function(e){return te(e)&&ie.call(e,"callee")&&!ae.call(e,"callee")},se=Array.isArray,ce=n(10),le={};le["[object Float32Array]"]=le["[object Float64Array]"]=le["[object Int8Array]"]=le["[object Int16Array]"]=le["[object Int32Array]"]=le["[object Uint8Array]"]=le["[object Uint8ClampedArray]"]=le["[object Uint16Array]"]=le["[object Uint32Array]"]=!0,le["[object Arguments]"]=le["[object Array]"]=le["[object ArrayBuffer]"]=le["[object Boolean]"]=le["[object DataView]"]=le["[object Date]"]=le["[object Error]"]=le["[object Function]"]=le["[object Map]"]=le["[object Number]"]=le["[object Object]"]=le["[object RegExp]"]=le["[object Set]"]=le["[object String]"]=le["[object WeakMap]"]=!1;var ue=n(6),pe=ue.a&&ue.a.isTypedArray,fe=pe?function(e){return function(t){return e(t)}}(pe):function(e){return te(e)&&q(e.length)&&!!le[v(e)]},de=Object.prototype.hasOwnProperty,he=function(e,t){var n=se(e),r=!n&&oe(e),i=!n&&!r&&Object(ce.a)(e),a=!n&&!r&&!i&&fe(e),o=n||r||i||a,s=o?ee(e.length,String):[],c=s.length;for(var l in e)!t&&!de.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||K(l,c))||s.push(l);return s},ve=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ge=Object.prototype.hasOwnProperty,me=function(e){if(!Y(e))return ve(e);var t=[];for(var n in Object(e))ge.call(e,n)&&"constructor"!=n&&t.push(n);return t},ye=function(e){return Q(e)?he(e):me(e)},be=Object.prototype.hasOwnProperty;!function(e){W(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,o&&$(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}(function(e,t){if(Y(t)||Q(t))D(t,ye(t),e);else for(var n in t)be.call(t,n)&&j(e,n,t[n])})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="Unknown"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var i=r(1),a=r(11),o="object"==typeof t&&t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===o?i.a.Buffer:void 0,l=(c?c.isBuffer:void 0)||a.a;n.a=l}).call(this,r(9)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,a){e?(r(U,e,n),i(e)):t(function(e,t){e?(r(U,e,n),i(e)):a(new M("GetAuthTokenError","Auth token is undefined",t))},function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";a(new M("GetAuthTokenError",r,t,n))})})}function a(e,t){var n=function(e){return"df"===e?x.Dogfood:"msit"===e?x.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return x.Dogfood;case"Msit":return x.MSIT;case"Blackforest":return x.Blackforest;case"GccModerate":return x.GccModerate;case"GccHigh":return x.GccHigh;case"DoD":return x.DOD;case"Gallatin":return x.Gallatin;case"Prod":return x.TopLevel;case"AG08":return x.AG08;case"AG09":return x.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(F.a)(e)}}(t)),n}function o(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function s(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return D.replace("{0}",r).replace("{1}",n)}(t,o(V,n)),e,R(R({},t),{clientFeature:"LivePersonaCard"}),n)}function c(e,t,n){return l(function(e,t){var n=t||e.culture,r=a(e.region,e.complianceEnvironment);return N.replace("{0}",r).replace("{1}",n)}(t,o(q,n)),e,R(R({},t),{clientFeature:"LivePersonaEditor"}),n)}function l(e,t,n,r){return new Promise(function(i,a){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Authorization","Bearer "+t),s.setRequestHeader("Accept","application/json");var c=B.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientFeature",n.clientFeature);var l=o(J,r)||n.clientType;l&&s.setRequestHeader("X-ClientType",l),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&s.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration));var u=o(W,r);if(u){var p={};u.split(";").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];p[n]=r}),s.setRequestHeader(W,JSON.stringify(p))}r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var f=o(z,r)||o(H,r);f&&(s.setRequestHeader(H,f),s.setRequestHeader(z,f));var d=o(Q,r);d&&s.setRequestHeader("X-"+Q,d);var h=o(X,r);h&&(s.setRequestHeader(X,h),s.setRequestHeader("X-"+X,h)),s.addEventListener("load",function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",i(e)}catch(e){a(new M("GetLokiConfigError","Failed to parse initialization config.",c))}else a(new M("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,!1,s.status))}),s.addEventListener("error",function(){a(new M("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),s.addEventListener("timeout",function(){a(new M("GetLokiConfigError","Loki config request timed out after "+G+" ms.",c))}),s.timeout=G,s.send()})}function u(e){var t=e.targetWindow||window,n=ne.get(t);return n?n.bootstrapperConfig=te(te({},n.bootstrapperConfig),e):n={bootstrapperConfig:te(te({},e),{targetWindow:t}),ariaLogger:new ee(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0},ne.set(t,n),n}function p(e,t,n){return re(this,void 0,void 0,function(){var r,i;return ie(this,function(a){switch(a.label){case 0:return(i=u(t)).lpcConfig?(r=i.lpcConfig,[3,3]):[3,1];case 1:return[4,f(e,t,n)];case 2:r=a.sent(),i.lpcConfig=r,a.label=3;case 3:return[2,r]}})})}function f(e,t,n){return re(this,void 0,void 0,function(){var r,a;return ie(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,s(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return oe<ae?(oe++,[4,f(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=oe,a;case 7:return[3,8];case 8:return[2,r]}})})}function d(e,t){var n=this,r=0,i=function(e,t){return se(n,void 0,void 0,function(){var n;return ce(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,6]),[4,h(e,t)];case 1:return a.sent(),[3,6];case 2:return n=a.sent(),r<le?(r++,[4,i(e,t)]):[3,4];case 3:return a.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function h(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new M("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}function v(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[fe],i=e.Resources[ue];"OwaPeopleHub"===e.Workload&&(i=e.Resources[pe]),n=[r,i]}return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function g(e,t){var n=t.targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new M("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new M("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var a=function(e,t){var n=t.targetWindow;return{refreshAuthToken:(r=t.getAuthToken,function(e){r(function(t,n){e(t,"",n,void 0)},function(t,n){e("",t,n,void 0)})}),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName};var r}(e,t);n.LPC.start(a),r()}catch(e){i(new M("StartLivePersonaCardError",e.name))}},0)})}function m(e){switch(e.complianceEnvironment){case"Blackforest":return he;case"GccHigh":return ve;case"DoD":return ge;case"Gallatin":return me;case"AG08":return ye;case"AG09":return be;case"GccModerate":case"Prod":default:return de}}function y(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function b(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function S(e){return void 0===e||"string"!=typeof e||""===e||null===e}function C(e){return void 0===e||"function"!=typeof e}function P(e){var t="";if(e){var n=[];S(e.culture)&&n.push("culture"),S(e.clientType)&&n.push("clientType"),S(e.clientContextType)&&n.push("clientContextType"),S(e.clientCorrelationId)&&n.push("clientCorrelationId"),C(e.logMessage)&&n.push("logMessage"),C(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===Ce.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+Ce.join(", ")+" for pre-production environments. "),-1===Pe.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+Pe.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new M("ValidateBootstrapperConfigError",t)}function k(e,t,n){return ke(this,void 0,void 0,function(){var r,i;return we(this,function(a){switch(a.label){case 0:return(i=u(t)).lpeConfig?(r=i.lpeConfig,[3,3]):[3,1];case 1:return[4,w(e,t,n)];case 2:r=a.sent(),i.lpeConfig=r,a.label=3;case 3:return[2,r]}})})}function w(e,t,n){return ke(this,void 0,void 0,function(){var r,a;return we(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,c(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,i(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return Ae<Te?(Ae++,[4,k(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=Ae,a;case 7:return[3,8];case 8:return[2,r]}})})}function T(e,t){if(-1===e.Flights.indexOf(xe))return Promise.reject(new M("LoadLivePersonaEditorScriptError","LPE not enabled",e.RootCorrelationId));var n=[e.Resources[Oe],e.Flights.indexOf(Ee)>-1?e.Resources[Ie]:e.Resources[Le]];return Promise.all(n.map(function(e){return d(e,t)})).then(function(){return n})}function A(e){return Ue(this,void 0,void 0,function(){var t,n,r,a=this;return Fe(this,function(o){return t=new Se(window),n=u(e),r=function(){return u(e).ariaLogger},!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise?[2,n.lpeInitializationPromise]:(n.lpeInitializationPromise=new Promise(function(n,o){return Ue(a,void 0,void 0,function(){var a,s,c,l,u,p;return Fe(this,function(f){switch(f.label){case 0:a=m(e),f.label=1;case 1:return f.trys.push([1,6,,7]),P(e),t.startCustomTiming(j.getAuthToken),[4,i(e.authToken,e.getAuthToken,window)];case 2:return s=f.sent(),t.endCustomTiming(j.getAuthToken),t.measureFromStart(j.getAuthTokenFromStart),t.startCustomTiming(j.getLokiConfig),[4,k(s,e,window)];case 3:return c=f.sent(),t.endCustomTiming(j.getLokiConfig),t.measureFromStart(j.getLokiConfigFromStart),t.startCustomTiming(j.getLpeBundles),[4,T(c,window)];case 4:return f.sent(),t.endCustomTiming(j.getLpeBundles),t.measureFromStart(j.getLpeBundlesFromStart),[4,r().updateContextWithLokiDataAsync(c,a).catch(function(){console.log("Live Persona Editor ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return f.sent(),(l=b(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,l.isConsumer=e.isConsumer,r().logEventAsync({name:"initializeLivePersonaEditor_success",properties:l},a),n(c),[3,7];case 6:return u=f.sent(),p=b(t.getAllTimings()),r().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:Me(Me(Me({},y(u)),p),{isConsumer:e.isConsumer})},a),o("Failed to initialize Live Persona Editor: "+u.name+" "+u.message),[3,7];case 7:return[2]}})})}),n.lpeInitializationPromise.catch(function(){setTimeout(function(){n.forceRefreshLpeInitializationPromise=!0},E)}),[2,n.lpeInitializationPromise])})})}function I(e){return je(this,void 0,void 0,function(){var t,n,r,a,o=this;return De(this,function(s){return t=u(e),n=function(){return u(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(r=t.bootstrapperConfig.targetWindow,a=new Se(r),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(s,c){return je(o,void 0,void 0,function(){var o,l,u,f,d,h;return De(this,function(S){switch(S.label){case 0:o=m(e),S.label=1;case 1:return S.trys.push([1,7,,8]),P(e),a.startCustomTiming(j.getAuthToken),[4,i(e.authToken,e.getAuthToken,r)];case 2:return l=S.sent(),a.endCustomTiming(j.getAuthToken),a.measureFromStart(j.getAuthTokenFromStart),a.startCustomTiming(j.getLokiConfig),[4,p(l,e,r)];case 3:return u=S.sent(),a.endCustomTiming(j.getLokiConfig),a.measureFromStart(j.getLokiConfigFromStart),a.startCustomTiming(j.getLpcBundles),[4,v(u,r)];case 4:return S.sent(),a.endCustomTiming(j.getLpcBundles),a.measureFromStart(j.getLpcBundlesFromStart),a.startCustomTiming(j.startLpc),[4,g(u,t.bootstrapperConfig)];case 5:return S.sent(),a.endCustomTiming(j.startLpc),a.measureFromStart(j.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(u,o).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return S.sent(),(f=b(a.getAllTimings())).RootCorrelationId=u.RootCorrelationId,f.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:f},o),s(),[3,8];case 7:return d=S.sent(),h=b(a.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:_e(_e(_e({},y(d)),h),{isConsumer:e.isConsumer})},o),c("Failed to initialize Live Persona Card: "+d.name+" "+d.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){t.forceRefreshInitializationTimeout=window.setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},E)}),[2,t.initializationPromise])})})}function L(e){!function(e){var t=ne.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}ne.delete(e)}(e)}function O(e){return je(this,void 0,void 0,function(){var t;return De(this,function(n){switch(n.label){case 0:return t=u(e),[4,i(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,p(n.sent(),e,t.bootstrapperConfig.targetWindow)]}})})}n.r(t),n.d(t,"initializeLivePersonaEditorAsync",function(){return A}),n.d(t,"initializeLivePersonaCardAsync",function(){return I}),n.d(t,"freeBootstrapperMemory",function(){return L}),n.d(t,"fetchLokiConfigAsync",function(){return O});var x,E=3e5,M=function(e,t,n,r,i,a){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=i,this.numberOfRetries=a},U="LokiAuthToken",F=n(3);!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(x||(x={}));var _,j,D="{0}/api/v1/livepersonacard/configuration?cultureName={1}",N="{0}/api/v1/livepersonaeditor/configuration?cultureName={1}",B="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",R=function(){return(R=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},G=6e4,H="LivePersonaCardVersionOverride",V="LivePersonaCardCultureOverride",z="MidgardVersion",X="MidgardBranch",W="HostAppConfiguration",q="LivePersonaEditorCultureOverride",Q="LivePersonaEditorVersionOverride",J="ClientTypeOverride",K=(n(17),function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,52))}),$=function(){return K().then(function(e){return e.AWTLogManager})},Z=(_=function(){return K().then(function(e){return e.Logger})},function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}),Y=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ee=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return Z(this,void 0,void 0,function(){return Y(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,$()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return Z(this,void 0,void 0,function(){var n;return Y(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),n.setContext("flights",e.Flights.join(",")),n.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return Z(this,void 0,void 0,function(){var t,n,r;return Y(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,$()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r,disableCookiesUsage:!0}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20210906.6.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getCollectorUrlAsync=function(){return Z(this,void 0,void 0,function(){return Y(this,function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,"https://de.pipe.aria.microsoft.com/Collector/3.0/"];case"GccHigh":return[2,"https://tb.pipe.aria.microsoft.com/Collector/3.0"];case"DoD":return[2,"https://pf.pipe.aria.microsoft.com/Collector/3.0"];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]})})},e.prototype.noOp=function(){},e}(),te=function(){return(te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ne=new WeakMap,re=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},ie=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ae=2,oe=0,se=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},ce=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},le=2,ue="livepersonacard_with-react",pe="livepersonacard_without-react",fe="livepersonacardstrings",de="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",he="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",ve="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",ge="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",me="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998",ye="",be="";!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(j||(j={}));var Se=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}(),Ce=["msit","df","ppe"],Pe=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"],ke=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},we=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},Te=2,Ae=0,Ie="livepersonaeditor_with-react",Le="livepersonaeditor_without-react",Oe="livepersonaeditorstrings",xe="iscapiv3enabled",Ee="withreact",Me=function(){return(Me=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},Fe=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},je=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},De=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};try{var Ne=window.document.createElement("link"),Be=Boolean("onmscontentzoom"in window.document);Ne.rel=Be?"dns-prefetch":"preconnect",Ne.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Ne)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}},,,,function(e,t,n){"use strict";function r(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}var i=n(20),a=n(8),o=n(5),s=n(0),c=n(4),l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},p=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},f=function(){function e(e,t,n,i,a,o,c){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=i,this.staticProperties=a,this.lookupError=o,this.isVerboseLoggingEnabled=c,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.transactionId=function(){for(var e=r(),t=0,n="",i=0;i<36;i++)switch(i){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[i-t]%4+8).toString(16);break;default:n+=(e[i-t]%16).toString(16)}return n}(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(e){return e.broadcastFlush()})},e.prototype.success=function(e,t){this.endEvent(e,s.a.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,s.a.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,s.a.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,s.a.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=s.a.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return u(this,void 0,void 0,function(){var r,o,s,l,u,f;return p(this,function(p){switch(p.label){case 0:return!Object(c.a)(this.featureName)||Object(c.b)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(r=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return o=p.sent(),l=(s=o).broadcastEvent,f={eventId:r,version:this.monitoringData.version?this.monitoringData.version:a.a,type:"QoS"},n&&Object(i.a)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=p.sent(),[3,4];case 3:u=void 0,p.label=4;case 4:l.apply(s,[(f.midgardError=u,f.source=this.monitoringData.source,f.featureName=this.featureName,f.clientCorrelationid=this.monitoringData.clientCorrelationId,f.qosScenarioName=this.scenarioName,f.qosEventType=t,f.qosTagId=null===e?void 0:e,f.duration=this.duration,f.properties=this.getProperties(n),f)]),p.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(e){var t;return l(l(l(l({},e),((t={})[o.a.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[o.a.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.a=f},,,function(e,t,n){"use strict";function r(e){return"object"==typeof e&&!!e&&Object(i.a)(e,"family")&&Object(i.a)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}n.d(t,"a",function(){return r});var i=n(7)}])})},2296:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),s=n(135),c=n(2297),l=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},u=function(e,t){return function(n,r){return void 0===r&&(r=!1),i(void 0,void 0,void 0,function(){var i,o,s;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=a.sent()))throw"Invalid chat conversation.";return[3,3];case 2:return o=a.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),[2,Promise.reject("_placeCall(): Failed to find chat conversation with error "+s)];case 3:return[2,t.placeCall({conversationId:i.id,withVideo:r,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]}})})}},p=function(e,t){return function(n,r){return i(void 0,void 0,void 0,function(){var i,o,s,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.getChatConversationWith(n)];case 1:if(!(i=a.sent()))throw"Invalid chat conversation";return[3,3];case 2:return o=a.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),[2,Promise.reject("_sendMessage(): Cannot find the chat with error "+s)];case 3:return c=SkypeX.Services.Utilities.newClientMessageId(),[2,t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:c,externalId:null,draftObjectId:null,inlineImages:null})]}})})}},f=function(e,t,n,c,l,u,p){return function(f,d){var h=f.persona;return i(void 0,void 0,void 0,function(){var i,f,v,g,m,y,b,S;return a(this,function(a){switch(a.label){case 0:t.info("LPC::Starting chat"),a.label=1;case 1:return a.trys.push([1,5,,6]),i=n.getFreshnessInMs(),f=e.scenarios.people.lpcStartChat,[4,n.getAllPeopleProfile([h.TeamsMri],f,!1,!1,i)];case 2:return v=a.sent()[0],g=l.isCurrentUserTFLOrMsaAccount(),(m=s.getIsMixedChatUser(g,v.type))&&v.type===e.userTypes.tflConsumer&&(v=r(r({},v),{mri:h.TeamsMri.replace("8:","8:tfl:")})),[4,c.getConversationWithV2(v.mri,f)];case 3:return y=a.sent(),[4,u({groupName:v.displayName,peopleSlug:y.id,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 4:return a.sent(),d(!0),p(o.LpcCallbackTelemetryType.lpcStartChat,v.mri),[3,6];case 5:return b=a.sent(),S="Failed to navigate to chat",t.error(S),d(!1,S),[3,6];case 6:return[2]}})})}},d=function(e,t,n,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,u,p,f,d;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),i=n.getFreshnessInMs(),u=e.scenarios.people.lpcOrgChart,[4,n.getAllPeopleProfile([c.TeamsMri],u,!1,!1,i)];case 1:return p=a.sent()[0],[4,r({groupName:p.displayName,slug:c.TeamsMri,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return a.sent(),l(!0),s(o.LpcCallbackTelemetryType.lpcOrgChart,c.TeamsMri),[3,4];case 3:return f=a.sent(),d="Failed to navigate to org chat",t.error(d),l(!1,d),[3,4];case 4:return[2]}})})}},h=function(e,t,n,r,s,c){return function(l,u){return i(void 0,void 0,void 0,function(){var i,p,f,d,h,v;return a(this,function(a){switch(a.label){case 0:i=l.TeamsMri,a.label=1;case 1:return a.trys.push([1,5,,6]),t.info("LPC::Navigating to user's LinkedIn"),p=e.scenarios.people.lpcLinkedIn,[4,n.getPeopleProfile(i,p,!1)];case 2:return f=a.sent(),[4,r.getChatConversationWith(i)];case 3:return d=a.sent(),[4,s({groupName:f.displayName,slug:d.id,middlePane:e.peopleTab.panes.linkedin,ctx:e.navigation.context.chat})];case 4:return a.sent(),u&&u(!0),c(o.LpcCallbackTelemetryType.lpcLinkedIn,i),[3,6];case 5:return h=a.sent(),v="Failed to navigate to LinkedIn.",t.error(v),u&&u(!1,v),[3,6];case 6:return[2]}})})}},v=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(r.TeamsMri)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcAudioCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start audio call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}},g=function(e,t,n){return function(r,s){return i(void 0,void 0,void 0,function(){var i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(r.TeamsMri,!0)];case 1:return a.sent(),s(!0),n(o.LpcCallbackTelemetryType.lpcVideoCall,r.TeamsMri),[3,3];case 2:return i=a.sent(),c="Failed to start video call with",e.error(c),s(!1,c),[3,3];case 3:return[2]}})})}};t.makeSendQuickMessage=function(e,t,n,r,s){return function(c,l,u){return i(void 0,void 0,void 0,function(){var i,p,f,d,h,v;return a(this,function(a){switch(a.label){case 0:if(i=c.TeamsMri)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),p=e.scenarios.people.lpcSendQuickMessage,[4,n.getAllShortPeopleProfile([c.Upn],p,!0,void 0,!0,void 0,!0)];case 2:return f=a.sent()[0],i=null===f||void 0===f?void 0:f.mri,[3,4];case 3:return d=a.sent(),v="Could not resolve user",t.error(v),u(!1,v),[2];case 4:return a.trys.push([4,6,,7]),t.info("LPC::Sending message to user, message length {0}",l&&l.length),[4,r(i,l)];case 5:return a.sent(),u(!0),s(o.LpcCallbackTelemetryType.lpcQuickIM,c.TeamsMri),[3,7];case 6:return h=a.sent(),v="Failed to send message",t.error(v),u(!1,v),[3,7];case 7:return[2]}})})}};var m=function(e,t,n,r,s,l,u,p){return function(f,d){return i(void 0,void 0,void 0,function(){var i,h,v,g,m,y,b,S,C;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),t.info("LPC::Blocking contact"),i=e.scenarios.people.lpcBlockContact,h=f.TeamsMri,[4,l.getAllShortPeopleProfile([h],i,!1,void 0,!0,void 0,!1)];case 1:return v=a.sent()[0],g=s.isCurrentUserTFLOrMsaAccount(),m=v.type,(y=c.isMixedChatUserinTFW(m,g,e.userTypes.tflConsumer))&&(h=f.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(h,"LivePersonaCard")];case 2:return(b=a.sent())?[4,u.acceptBlockChat(b.id,!1)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.addBlockedMri(f.TeamsMri,"LivePersonaCard")];case 5:a.sent(),a.label=6;case 6:return d(!0),p(o.LpcCallbackTelemetryType.lpcBlockContact,h),[3,8];case 7:return S=a.sent(),C="Failed to block contact",t.error(C),d(!1,C),[3,8];case 8:return[2]}})})}},y=function(e,t,n,r,s,l,u){return function(p,f){return i(void 0,void 0,void 0,function(){var i,d,h,v,g,m,y,b,S;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),t.info("LPC::Unblocking contact"),i=e.scenarios.people.lpcUnblockContact,d=p.TeamsMri,[4,l.getAllShortPeopleProfile([d],i,!1,void 0,!0,void 0,!1)];case 1:return h=a.sent()[0],v=s.isCurrentUserTFLOrMsaAccount(),g=h.type,(m=c.isMixedChatUserinTFW(g,v,e.userTypes.tflConsumer))&&(d=p.TeamsMri.replace("8:","8:tfl:")),[4,n.getConversationWithV2(d,"LivePersonaCard")];case 2:return(y=a.sent())?[4,n.acceptBlockSfCChat(y.id,!0,"LivePersonaCard")]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.deleteBlockedMri(p.TeamsMri,"LivePersonaCard")];case 5:a.sent(),a.label=6;case 6:return f(!0),u(o.LpcCallbackTelemetryType.lpcUnblockContact,d),[3,8];case 7:return b=a.sent(),S="Failed to unblock contact",t.error(S),f(!1,S),[3,8];case 8:return[2]}})})}},b=function(e,t,n,r,s){return function(c,l){return i(void 0,void 0,void 0,function(){var i,u,p,f;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.info("LPC::Edit Me Profile"),[4,r.getMeMSAProfile(n.scenarios.people.lpcEditProfile,!1)];case 1:return i=a.sent(),u=n.appHeaderBar.buttonid.profileButton,t.open(n.dialogs.updateUserProfile,{isFre:!1,preActiveElementIds:[u],user:i,isMSAEditNameClick:!0}),l(!0),s(o.LpcCallbackTelemetryType.lpcEditMeProfile,c.TeamsMri),[3,3];case 2:return p=a.sent(),f="Failed to edit me user profile",e.error(f),l(!1,f),[3,3];case 3:return[2]}})})}},S=function(e,t,n,r,s){if(n.valueAsBoolean(r.settings.names.enableManageAliasPrivacy))return function(n,c){return i(void 0,void 0,void 0,function(){var i;return a(this,function(a){try{e.info("LPC::Manage discoverability settings"),t.open(r.dialogs.manageAliasPrivacyDialog,{backButtonShouldOpenSettings:!0}),c(!0),s(o.LpcCallbackTelemetryType.lpcManageDiscoverabilitySettings,n.TeamsMri)}catch(t){i="Failed to manage discoverability settings",e.error(i),c(!1,i)}return[2]})})}},C=function(e,t,n,r){if(n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings))return function(n){try{e.info("LPC::Manage alias visibility settings"),t.open(r.dialogs.manageAliasVisibilityDialog,{backButtonShouldOpenSettings:!0,referrer:r.manageAliasVisibilityDialogReferrer.lpcMeProfileCard}),n(!0)}catch(t){var i="Failed to open the Manage alias visibility settings dialog";e.error(i),n(!1,i)}}};t.LPCActionCallbackFactory=function(e,n,r,i,a,o,s,c,P,k,w,T,A,I){var L=l(n,e,s),O=u(a,c),x=p(a,P);return{startChat:f(n,r,i,a,o,L,I),showOrgChart:d(n,r,i,L,I),showLinkedIn:h(n,r,i,a,L,I),sendQuickMessage:t.makeSendQuickMessage(n,r,i,x,I),startVideoCall:g(r,O,I),startAudioCall:v(r,O,I),blockContact:m(n,r,a,k,o,i,A,I),unblockContact:y(n,r,a,k,o,i,I),editMeProfile:b(r,w,n,i,I),manageDiscoverabilitySettings:S(r,w,T,n,I),openAliasVisibilitySettings:C(r,w,T,n)}}},2297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(135);t.isMixedChatUserinTFW=function(e,t,n){return!t&&r.getIsMixedChatUser(t,e)&&e===n}},2298:function(e,t,n){"use strict";function r(e,t){return{disableChatFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartChatHeaderButton),disableOrgChartFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcOrgChartHeaderButton),disableVideoFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartVideoCallHeaderButton),disableAudioCallFromKillSwitch:e.valueAsBoolean(t.settings.names.disableLpcStartAudioCallHeaderButton)}}function i(e){return e&&validator.isEmail(e)}function a(e,t,n){var r=this;return function(i,a,o){return l(r,void 0,void 0,function(){var r,a,s,c,l,p;return u(this,function(u){switch(u.label){case 0:r=t.service.newScenario(n.scenarios.people.lpcGetOrgChart),a=i.TeamsMri||i.Smtp||i.Upn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getOrgChart(a,n.scenarios.people.lpcCallerName)];case 2:return(s=u.sent())?(c=d.getDirectReportsAndManager(s.value),r.stop(),o(c,void 0)):(p="No orgChart returned",t.error(p),r.stop({reason:p}),o(void 0,p)),[3,4];case 3:return l=u.sent(),p="Exception in orgChart call",t.error("getOrgChart failed in LPC data callback"),r.fail({reason:p}),o(void 0,p),[3,4];case 4:return[2]}})})}}function o(e,t,n,r,i,a,o){var s=this;return function(c,p,h){return l(s,void 0,void 0,function(){var s,l,p,v,g,m,y,b,S,C,P,k,w,T,A,I,O,x,E,M;return u(this,function(u){switch(u.label){case 0:s=t.service.newScenario(i.scenarios.people.lpcGetHeaderInfo),l=c.TeamsMri||c.Smtp||c.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),p=f.deserializeHostAppPersonaId(c.HostAppPersonaId),v=p.isSharedChannel,g=p.hostTenantId,m=p.hostConversationId,y=p.isExchangeOnlyContact,b=void 0,v?[4,e.getAllPeopleProfileForConversation([l],m,!1,i.scenarios.people.lpcGetHeaderInfoSC,void 0,v,g)]:[3,3];case 2:return b=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfoSC),[3,7];case 3:return y?[4,d.getPersonaProfileByContactId(c.OlsPersonaId,t,a,s,i.scenarios.people.lpcGetHeaderInfoEC)]:[3,5];case 4:return(b=u.sent())?[3,7]:[2,h(void 0,"No profile returned for exchange contact in LPC getHeaderInfoAndCardType callback")];case 5:return[4,e.getAllPeopleProfile([l],i.scenarios.people.lpcGetHeaderInfo,!Boolean(c.TeamsMri))];case 6:b=u.sent(),s.mark(i.scenarios.people.lpcGetHeaderInfo),u.label=7;case 7:return(S=b[0])?(C=S,P=n.getCurrentSkypeMri(),k=P===c.TeamsMri,w=f.determineCardTypeForTargetUser(C.role,C.type,k),T=r.valueAsBoolean(i.settings.names.showOnlySearchablePhonesAndEmailsInLPC),A=o.isCurrentUserTFLOrMsaAccount(),I=d.getIsMixedChatUser(A,C.type),O=v&&C.xtapUser?C.tenantName:void 0,x=L(w,C,T,I,O),s.stop(),h(x,void 0)):(M="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M)),[3,9];case 8:return E=u.sent(),M="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetHeaderInfoAndCardType callback"),s.fail({reason:M}),h(void 0,M),[3,9];case 9:return[2]}})})}}function s(e,t,n,r,i,a,o){var s=this;return function(c,p){return l(s,void 0,void 0,function(){var s,l,h,v,g,m,y,b,S,C,P,k,w,T,A,I,L,O,x,E,M,U;return u(this,function(u){switch(u.label){case 0:s=t.service.newScenario(r.scenarios.people.lpcGetPersonaInfo),l=c.TeamsMri||c.Smtp||c.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),h=f.deserializeHostAppPersonaId(c.HostAppPersonaId),v=h.isSharedChannel,g=h.hostTenantId,m=h.hostConversationId,y=h.isExchangeOnlyContact,b=void 0,v?[4,e.getAllPeopleProfileForConversation([l],m,!1,r.scenarios.people.lpcGetPersonaInfoSC,void 0,v,g)]:[3,3];case 2:return b=u.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfoSC),[3,7];case 3:return y?[4,d.getPersonaProfileByContactId(c.OlsPersonaId,t,i,s,r.scenarios.people.lpcGetPersonaInfoEC)]:[3,5];case 4:return(b=u.sent())?[3,7]:[2,p(void 0,"No profile returned for exchange contact in LPC getPersonaInfo callback")];case 5:return[4,e.getAllPeopleProfile([l],r.scenarios.people.lpcGetPersonaInfo,!Boolean(c.TeamsMri))];case 6:b=u.sent(),s.mark(r.scenarios.people.lpcGetPersonaInfo),u.label=7;case 7:return(S=b[0])?(C=S,P=a.isCurrentUserTFLOrMsaAccount(),k=d.getIsMixedChatUser(P,C.type),w=P&&k,T=v&&!!C.xtapUser,A=k||T?C.tenantName:C.department,I=n.valueAsBoolean(r.settings.names.showOnlySearchablePhonesAndEmailsInLPC)&&!w,L=n.valueAsBoolean(r.settings.names.enableAliasVisibilitySettings),O=o.getCurrentSkypeMri(),x=O===c.TeamsMri,E={hostAppPersonaId:c.HostAppPersonaId,aadObjectId:C.objectId,email:L&&P&&x?void 0:d.getEmail(C,I),extraEmails:L?d.getVisibleEmails(C):d.getEmails(C,I),upn:C.userPrincipalName,userType:f.determineLPCPersonaType(C.role,C.type),displayName:C.displayName,firstName:C.givenName,lastName:C.surname,skypeId:C.skypeId,isInformationBarrierBarred:C.isIbBarred,teamsMri:c.TeamsMri||C.mri,jobTitle:C.jobTitle,department:A,officeLocation:C.userLocation,phoneNumbersAndUrls:L?d.getVisiblePhones(C):d.getPhoneNumbers(C,I),isMixedChatUser:k},s.stop(),p(E,void 0)):(U="No profile returned",t.error("getAllPeopleProfile returned no profile in LPC GetPersonaInfo callback"),s.fail({reason:U}),p(void 0,U)),[3,9];case 8:return M=u.sent(),U="Exception in profile call",t.error("getAllPeopleProfile failed in LPC GetPersonaInfo callback"),s.fail({reason:U}),p(void 0,U),[3,9];case 9:return[2]}})})}}var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var p=n(57),f=n(311),d=n(135);t.convertHTMLEntities=function(e,t){return e=t.decodeHtml(e),e=t.replaceNewlines(e),e=e.replace(/=""/g,"")},t.unescapeHtmlEntities=function(e,n){if(!e)return e;var r=document.createElement("textarea"),i=(new DOMParser).parseFromString(e,"text/html").body.innerHTML.toString(),a=t.convertHTMLEntities(i,n);return r.textContent=a,r.value};var h=function(e,t,n,r,a){return function(o,s){return l(void 0,void 0,void 0,function(){var l,p,h,v,g,m,y,b,S,C,P,k,w,T;return u(this,function(u){switch(u.label){case 0:if(l=e.service.newScenario(n.scenarios.people.lpcGetImageUri),p=f.deserializeHostAppPersonaId(o.HostAppPersonaId),h=p.isSharedChannel,v=p.hostTenantId,g=p.hostConversationId,m=p.isExchangeOnlyContact,y={mri:o.TeamsMri,principalName:o.Upn||o.Smtp||o.TeamsMri,displayName:o.DisplayName||"",size:n.profilePictureSizes.medium},b=!1,S=i(y.principalName),C=h&&!S,o.DisplayName&&!C)return[3,9];P=o.TeamsMri||o.Smtp||o.Upn,u.label=1;case 1:return u.trys.push([1,8,,9]),k=void 0,h?[4,r.getAllPeopleProfileForConversation([P],g,!0,n.scenarios.people.lpcGetImageUriSC,void 0,h,v)]:[3,3];case 2:return k=u.sent(),l.mark(n.scenarios.people.lpcGetImageUriSC),[3,7];case 3:return m?[4,d.getPersonaProfileByContactId(o.OlsPersonaId,e,a,l,n.scenarios.people.lpcGetImageUriEC)]:[3,5];case 4:return k=u.sent(),[3,7];case 5:return[4,r.getAllShortPeopleProfile([P],n.scenarios.people.lpcGetImageUri,!Boolean(o.TeamsMri))];case 6:k=u.sent(),l.mark(n.scenarios.people.lpcGetImageUri),u.label=7;case 7:return(w=k[0])&&(y=c(c({},y),{displayName:w.displayName}),C&&(y=c(c({},y),{principalName:w.userPrincipalName})),w.isIbBarred&&(b=!0)),[3,9];case 8:return T=u.sent(),e.error("Failed to fetch persona profile in getAndPrefetchPersonaImageUri callback"),[3,9];case 9:return h&&(y=c(c({},y),{isSharedChannel:h,hostTenantId:v,conversationId:g})),m&&(y=c(c({},y),{isExchangeOnlyContact:m})),t.loadImage(y,!1,b,!1,h?n.scenarios.people.lpcGetImageUriSC:n.scenarios.people.lpcGetImageUri).then(function(e){var t=e&&e.imgUrl||"";l.stop(),s(t,{})}).catch(function(e){l.fail({reason:"Failed to fetch persona"}),s(void 0,void 0,e)}),[2]}})})}};t.getSkypeConsumerChatStatus=function(e,t,n,r){return l(void 0,void 0,void 0,function(){var i,a,o,s;return u(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,t.findConversationWith(n)];case 1:return(i=c.sent())&&i.isSfC()?(a=i.InteropConversationStatus())===e.interopConversationStatus.blocked?[2,p.PersonaPresence.blocked]:[2,p.PersonaPresence.none]:[2,void 0];case 2:return o=c.sent(),s=teamspace.services.AppsServiceUtils.getSafeError(o),r.debug("getSkypeConsumerChatStatus(): Failed to get skype consumer chat status with error "+s),[2,void 0];case 3:return[2]}})})};var v=function(e,n,r,i,a,o,s){return l(void 0,void 0,void 0,function(){var c,l,f,d;return u(this,function(u){switch(u.label){case 0:return[4,t.getSkypeConsumerChatStatus(r,i,o,s)];case 1:if(void 0!==(c=u.sent()))return[2,c];if(l=a.isBlockedContact(o))return[2,p.PersonaPresence.blocked];if(f=e.status,d=e.flwPresence,n.valueAsBoolean(r.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return[2,p.PersonaPresence.offline];if(d===SkypeX.Services.UserFlwPresence.OnShift)switch(f){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return[2,p.PersonaPresence.busy];default:return[2,p.PersonaPresence.online]}}switch(f){case SkypeX.Services.UserStatus.Online:return[2,p.PersonaPresence.online];case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return[2,p.PersonaPresence.offline];case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return[2,p.PersonaPresence.away];case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return[2,p.PersonaPresence.busy];case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return[2,p.PersonaPresence.dnd];default:return[2,p.PersonaPresence.offline]}return[2]}})})},g=function(e,t,n,r,i,a,o){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),l=c.length>0?c[c.length-1]:null;l&&(t=a.instant(o.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:l}))}return a.instant(o.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},m=function(e,t,n,r,i,a,o,s,c){var l=e.status,u=e.calendarData,p=e.lastSeenAt,f=e.flwPresence,d=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(f===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(f===SkypeX.Services.UserFlwPresence.OnShift){var h=void 0,v=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(d);switch(m&&m.currentShift&&(h=c.getDate(new Date(m.currentShift.endTime),"shortTime"),v=m.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return g(y,h,v,s,c,r,a);default:var b=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return g(b,h,v,s,c,r,a)}}}var S=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(u&&u.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return S?r.instant(a.strings.person_card_last_seen_time_with_prefix,{lastSeenTime:o.transformIntoTimeago(p)}):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l)}},y=function(e,t,n,r,i){var a="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(a=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),a},b=function(e,t,n,r,i,a){var o={message:"",publishTime:""};if(e.note){var s=e.note.message,c=e.note.publishTime;if(c&&c.trim()){var l=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(l)}if(s){var u=r.stripHtml(i.sanitizeHtml(s)).trim(),p=y(e,0,0,r,i);u.length&&!p.length&&(o.message=u)}}return o.message&&o.publishTime?o:void 0},S=function(e,n,r,i){var a=[],o=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=e.decodeHtml(i.attribs["data-itemprops"]),l=d.removeZeroWidthSpace(c),u=JSON.parse(l).mri;a.push({text:t.unescapeHtmlEntities(s,e),hostAppPersonaId:u,mri:u})}else"text"===i.type?a.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i),e),hostAppPersonaId:void 0}):"br"===i.name?a.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&o(i.children)})};return o(i),a},C=function(e,t,n,r,i,a){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var o={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var l=i.sanitizeHtml(s).trim(),u=window.htmlparser2,p=u.parseDOM("<div>"+l+"</div>"),f=S(r,n,u,p);o.message=f}if(c&&c.trim()){var d=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(d)}return o.message.length&&o.publishTime?o:void 0}},P=function(e,t,n,r,i,a,o,s,c,p,f,d,h,g,S){return function(P,k){return l(void 0,void 0,void 0,function(){var l,w,T;return u(this,function(u){switch(u.label){case 0:return l=e.getPresence(P,k),T={},[4,v(l,i,a,h,g,P,S)];case 1:return T.presence=u.sent(),T.isOutOfOffice=l&&!!l.calendarData&&!!l.calendarData.isOutOfOffice,T.oofMessage=l&&y(l,0,0,t,n),T.presenceText=l&&m(l,i,o,s,a,c,p,f,d),T.statusNote=l&&b(l,0,0,t,n,r),T.statusNoteV2=l&&C(l,i,a,t,n,r),w=T,[2,w]}})})}},k=function(e,t,n,r){return function(i){return l(void 0,void 0,void 0,function(){var a,o,s,c,l,p;return u(this,function(u){switch(u.label){case 0:a=t.getRootRouteParams(),o=a&&a.ctx===n.navigation.context.chat&&a.slug,u.label=1;case 1:return u.trys.push([1,6,,7]),o?[4,e.getConversation(a.slug)]:[3,3];case 2:(s=u.sent())&&!s.isOneOnOne()&&(s=void 0),u.label=3;case 3:return(c=s)?[3,5]:[4,e.findConversationWith(i)];case 4:c=u.sent(),u.label=5;case 5:return(s=c)&&s.isInteropChat()?[2,Promise.resolve(SkypeX.Services.PresenceSource.SFB)]:[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 6:return l=u.sent(),p=teamspace.services.AppsServiceUtils.getSafeError(l),r.debug("getPresenceSourceInternal(): Failed to get presence with error "+p),[2,Promise.resolve(SkypeX.Services.PresenceSource.UPS)];case 7:return[2]}})})}},w=function(e,t,n,r,i,a,o,s,c,p,d,h,v,g,m,y){return function(b,S){return l(void 0,void 0,void 0,function(){var l,C,w,T,A,I,L,O;return u(this,function(u){switch(u.label){case 0:if(l=f.deserializeHostAppPersonaId(b.HostAppPersonaId).isExchangeOnlyContact)return[2,S(null,void 0)];C=y.service.newScenario(o.scenarios.people.lpcGetRichPresence),u.label=1;case 1:return u.trys.push([1,4,,5]),w=k(e,m,o,y),T=P(t,n,r,i,a,o,s,c,p,d,h,v,e,g,y),[4,w(b.TeamsMri)];case 2:return A=u.sent(),[4,T(b.TeamsMri,A)];case 3:return I=u.sent(),C.stop(),S(I,void 0),[3,5];case 4:return L=u.sent(),C.fail(),O=teamspace.services.AppsServiceUtils.getSafeError(L),S(void 0,"getPresenceCallback(): Failed to execute presence callback with error "+O),[3,5];case 5:return[2]}})})}},T=function(e,t,n,i,a,o,s,c,p,h,v,g){return function(m){return l(void 0,void 0,void 0,function(){var l,y,b,S,C,P,k,w,T,A,I,L,O,x,E,M,U,F,_,j,D,N,B,R,G,H,V,z,X,W,q,Q,J,K,$,Z,Y,ee,te,ne,re;return u(this,function(u){switch(u.label){case 0:if(l=i.service.newScenario(a.scenarios.people.lpcGetHeaderActionsPolicy),y=p.getCurrentSkypeMri(),b=y===m.TeamsMri,S=f.deserializeHostAppPersonaId(m.HostAppPersonaId),C=S.isSharedChannel,P=S.hostTenantId,k=S.hostConversationId,w=S.isExchangeOnlyContact,b||w)return b?l.stop({reason:"User is me"}):l.stop({reason:"Out-of-tenant outlook Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}];T=!c.isCurrentUserTFLOrMsaAccount(),A={disableChat:!1,disableOrg:!0,disableCall:!1,disableVideo:!1,disableBlockUnblock:T},I=s.isBlockedContact(m.TeamsMri),L=r(g,a),O=L.disableChatFromKillSwitch,x=L.disableOrgChartFromKillSwitch,E=L.disableVideoFromKillSwitch,M=L.disableAudioCallFromKillSwitch,U=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling),A.disableCall=M||!U,A.disableVideo=E||!U,F=t.getSettingValue(SkypeX.Services.MessagingPolicySettingsStorageKey.allowUserChat),u.label=1;case 1:return u.trys.push([1,12,,13]),_=void 0,C?[4,n.getAllPeopleProfileForConversation([m.TeamsMri],k,!1,a.scenarios.people.lpcGetHeaderActionsPolicySC,void 0,C,P)]:[3,3];case 2:return _=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicySC),[3,5];case 3:return[4,n.getAllPeopleProfile([m.TeamsMri],a.scenarios.people.lpcGetHeaderActionsPolicy,!m.TeamsMri)];case 4:_=u.sent(),l.mark(a.scenarios.people.lpcGetHeaderActionsPolicy),u.label=5;case 5:return(j=_[0])?(D=j.featureSettings,N=j.type,B=j.userType,R=j.isAnonymousUser,G=j.mri,H=j.isIbBarred,R||H?(R?l.stop({reason:"Anonymous User"}):l.stop({reason:"IB Barred User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!0}]):(V=c.isCurrentUserTFLOrMsaAccount(),z=d.getIsMixedChatUser(V,j.type),X="SkypeConsumer"===j.type,W=z||X,q=!W&&T,I?(l.stop({reason:"Blocked Contact"}),[2,{disableChat:!0,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:q}]):X?[2,{disableChat:O||!1,disableOrg:!0,disableCall:M||!1,disableVideo:E||!1,disableBlockUnblock:!1}]:z?[2,{disableChat:O||!1,disableOrg:!0,disableCall:!0,disableVideo:!0,disableBlockUnblock:!1}]:(Q=SkypeX.Services.ChatServiceUtils.isPstnMri(G))?(l.stop({reason:"PSTN User"}),[2,{disableChat:!0,disableOrg:!0,disableCall:M||!1,disableVideo:!0,disableBlockUnblock:!0}]):(J=D&&D.isPrivateChatEnabled,K=N&&N.toLowerCase()===a.userTypes.person.toLowerCase(),$=B&&B.toLowerCase()===a.userTypes.guest.toLowerCase(),Z=o===teamspace.services.UserTypeInTenant.Guest,A.disableChat=O||!1===J||!F,A.disableOrg=x||!(K&&!$)||Z,A.disableChat?[3,10]:[4,h.getChatConversationWith(G)]))):[3,11];case 6:if(!(Y=u.sent())||SkypeX.Services.SkypeConversationLocal.isLie(Y.id))return[3,10];u.label=7;case 7:return u.trys.push([7,9,,10]),[4,v.validateUpgradePolicyOfChatRecipient(Y.id,!1)];case 8:return ee=u.sent(),te=ee&&ee.isValidChat,A.disableChat=!te,[3,10];case 9:return ne=u.sent(),i.error("Failed to validate chat in LPC data callbacks"),[3,10];case 10:l.stop(),u.label=11;case 11:return[3,13];case 12:return re=u.sent(),l.fail({reason:"Error while fetching persona"}),i.error("Failed to fetch persona profile in LPC data callbacks"),[3,13];case 13:return[2,A]}})})}},A=function(e,t,n,r,i){var a=d.getEmail(t,n);return{cardType:e,headerInfo:{userHeaderInfo:{displayName:t.displayName,firstName:t.givenName,lastName:t.surname,title:t.jobTitle,department:r?t.tenantName:t.department,location:t.userLocation,profilePictureUrl:t.imageUri,mobilePhone:t.mobile,phone:d.getPhoneNumber(t,n),userPrincipalName:t.userPrincipalName,email:a&&a.Address,imAddress:t.skypeId,tenantName:i},isMixedChatUser:r}}},I=function(e,t){return{cardType:e,headerInfo:{unresolvedHeaderInfo:{email:t}}}},L=function(e,t,n,r,i){return"NotResolved"===e?I(e,t.email):A(e,t,n,r,i)};t.makeGetHeaderInfoAndCardTypeCallback=o,t.GetPresenceSourceFunction=k,t.GetRichPresenceFunction=P,t.LPCDataCallbackFactory=function(e,t,n,r,i,c,l,u,p,f,d,v,g,m,y,b,S,C,P,k,A,I,L,O,x){return{getAndPrefetchPersonaImageUri:h(e,b,p,r,x),getRichPresence:w(t,n,i,c,l,u,p,f,d,v,g,m,y,S,L,e),getHeaderActionsPolicyAsync:T(C,P,r,e,p,k,S,I,A,t,O,u),getPersonaInfo:s(r,e,u,p,x,I,A),getOrgChart:a(r,e,p),getHeaderInfoAndCardType:o(r,e,A,u,p,x,I)}}},2299:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.newSecondPartyOneDsLogger(t,n),[2]})})}},o=function(e){return function(t,n){return r(void 0,void 0,void 0,function(){return i(this,function(r){return e.logSecondPartyEvent(t,n),[2]})})}};t.LPCTelemetryCallbackFactory=function(e){return{initializeExternalOneDsTelemetry:a(e),sendExternalOneDsTelemetryEvent:o(e)}}},2300:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2301);t.defaultTheme=r.defaultTheme;var i=n(2302);t.darkTheme=i.darkTheme;var a=n(2303);t.highContrastTheme=a.highContrastTheme},2301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#5B5FC7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)",purpleLight:"#E5E5F1",purpleDark:"#6264a7",neutralDark:"#D1D1D1"};t.defaultTheme={palette:i,isInverted:!1}},2302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#9399f5",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff",purpleLight:"#3D3E66",purpleDark:"#9ea2ff",neutralDark:"#616161"},t.darkTheme={palette:t.darkThemePalette,isInverted:!0}},2303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",a={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r,purpleLight:"#ffff01",purpleDark:"#000",neutralDark:"#fff"};t.highContrastTheme={palette:a,isInverted:!0}},2304:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var a=teamspace.components.PanelActionGesture,o=teamspace.components.PanelActionOutcome,s=teamspace.components.PanelActionScenario,c=teamspace.components.PanelActionScenarioType,l=teamspace.components.PanelModuleName,u=teamspace.components.PanelModuleType,p=teamspace.components.WorkLoad,f=teamspace.components.SubWorkLoad,d=n(57),h=function(){function e(e,t,n){this.analyticsService=e,this.loggingService=t,this.conversationsAsyncService=n}return e.prototype.logPanelActionEvent=function(e,t){return r(this,void 0,void 0,function(){var n,r,h,v,g,m,y,b,S,C,P,k,w,T,A,I=this;return i(this,function(i){switch(i.label){case 0:switch(m=u.people,b=o.nav,S=o.nav,C=c.people,P=teamspace.PanelRegion.popover,k=p.chatContent,w=f.composeMsg,e){case d.LpcCallbackTelemetryType.lpcAudioCall:r=a.click,h=s.navCalling,v=l.lpcAudioCall,n="lpcAudioCall";break;case d.LpcCallbackTelemetryType.lpcStartChat:r=a.click,h=s.navChat,v=l.lpcStartChat,n="lpcStartChat";break;case d.LpcCallbackTelemetryType.lpcOrgChart:r=a.click,h=s.orgChart,v=l.lpcOrgChart,n="lpcOrgChart";break;case d.LpcCallbackTelemetryType.lpcQuickIM:r=a.click,b=o.submit,S=o.submit,h=s.quickIM,v=l.lpcQuickIM,g=l.sendButton,y=u.compose,n="lpcQuickIM";break;case d.LpcCallbackTelemetryType.lpcVideoCall:r=a.click,h=s.navCalling,v=l.lpcVideoCall,n="lpcVideoCall";break;case d.LpcCallbackTelemetryType.lpcBlockContact:r=a.click,h=s.blockUser,v=l.lpcBlockContact,n="lpcBlockContact";break;case d.LpcCallbackTelemetryType.lpcUnblockContact:r=a.click,h=s.unblockUser,v=l.lpcUnblockContact,n="lpcUnblockContact";break;case d.LpcCallbackTelemetryType.lpcLinkedIn:r=a.click,h=s.navLinkedIn,v=l.lpcLinkedIn,n="lpcLinkedIn";break;default:return[2]}return A={action:{gesture:r,outcome:b,outcomeNew:S,scenario:h?teamspace.shared.AttributeHelper.tryGetEnum(h.toString(),s,this.loggingService):null,scenarioType:C?teamspace.shared.AttributeHelper.tryGetEnum(C.toString(),c,this.loggingService):null,workLoad:teamspace.shared.AttributeHelper.tryGetEnum(k.toString(),p,this.loggingService),subWorkLoad:teamspace.shared.AttributeHelper.tryGetEnum(w.toString(),f,this.loggingService)},module:{name:v?teamspace.shared.AttributeHelper.tryGetEnum(v.toString(),l,this.loggingService):null,nameNew:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),l,this.loggingService):null,type:m?teamspace.shared.AttributeHelper.tryGetEnum(m.toString(),u,this.loggingService):null,typeNew:y?teamspace.shared.AttributeHelper.tryGetEnum(y.toString(),u,this.loggingService):null,summary:n}},[4,this.getTargetThreadType(t)];case 1:return A.targetThread=i.sent(),T=A,this.analyticsService.getAnalyticsPanelActionEventData(T,P).then(function(e){I.analyticsService.sendPanelAction(e)}),[2]}})})},e.prototype.getTargetThreadType=function(e){return r(this,void 0,void 0,function(){var t,n,r,a;return i(this,function(i){switch(i.label){case 0:if(!e)return[2,null];t="OneOnOneChat",i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.conversationsAsyncService.getConversation(e)];case 2:return n=i.sent(),t=n&&n.conversationType||t,[3,5];case 3:return r=i.sent(),a=teamspace.services.AppsServiceUtils.getSafeError(r),this.loggingService.error("getTargetThreadType(): Failed to get conversation with error "+JSON.stringify(a)),[3,5];case 4:return[2,{type:t}];case 5:return[2]}})})},e}();t.LpcTelemetryHelper=h},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.determineLPCPersonaType=function(e,t){switch(t){case"Federated":case"SkypeConsumer":return"External";case"person":return"Guest"===e?"NotResolved":"User";default:return"User"}},t.determineCardTypeForTargetUser=function(e,t,n){if(n)return"Me";switch(t){case"Federated":case"SkypeConsumer":case"TflConsumer":return"External";case"person":case"ADUser":return"Guest"===e?"Guest":"User";default:return"User"}},t.getCleanUpn=function(e){return!e||SkypeX.Services.ChatServiceUtils.isMri(e)?void 0:e},t.serializeHostAppPersonaId=function(e){return JSON.stringify(e)},t.isLinkedInEnabled=function(e,t){return e.valueAsBoolean(t.settings.names.enableLinkedInTab)&&e.valueAsBoolean(t.settings.names.enableLinkedInInLPC)},t.deserializeHostAppPersonaId=function(e){if(!e)return{userId:void 0,isSharedChannel:!1,hostTenantId:void 0,hostConversationId:void 0,isExchangeOnlyContact:!1};var t=JSON.parse(e);return{userId:t.userId,isSharedChannel:!0===t.isSharedChannel,hostTenantId:t.hostTenantId,hostConversationId:t.hostConversationId,isExchangeOnlyContact:!0===t.isExchangeOnlyContact}},t.getTimeFormat=function(e){var t,n,r=null===(n=null===(t=e.getLocaleInfo())||void 0===t?void 0:t.date)||void 0===n?void 0:n.shortTime;return"HH:mm"===r?[r,!0]:[r,!1]}},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark",e.DefaultV2="defaultV2",e.DarkV2="darkV2"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.lpcAudioCall=0]="lpcAudioCall",e[e.lpcStartChat=1]="lpcStartChat",e[e.lpcEditMeProfile=2]="lpcEditMeProfile",e[e.lpcOrgChart=3]="lpcOrgChart",e[e.lpcLinkedIn=4]="lpcLinkedIn",e[e.lpcQuickIM=5]="lpcQuickIM",e[e.lpcVideoCall=6]="lpcVideoCall",e[e.lpcBlockContact=7]="lpcBlockContact",e[e.lpcUnblockContact=8]="lpcUnblockContact",e[e.lpcManageDiscoverabilitySettings=9]="lpcManageDiscoverabilitySettings",e[e.personImageCallback=10]="personImageCallback",e[e.richPresenceCallback=11]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}));!function(e){e.Public="Public",e.Private="Private"}(t.AliasVisibility||(t.AliasVisibility={}))}},[2293]);