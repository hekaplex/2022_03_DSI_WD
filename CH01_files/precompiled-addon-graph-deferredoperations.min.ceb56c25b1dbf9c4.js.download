(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[57],{"6e15b94262f5115185b6":function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=n("52c0e9e1090488830143");function r(e){return!!e.fileHandler}function i(e){return r(e)&&!!e.promoted}var c=/^(?:data|blob|javascript):/i,o=/^(?:data|http|https):/i;function s(e){return!c.test(e)}var d={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function l(e){var a,n;if(e)for(var t in e)if(d.hasOwnProperty(t)){var r=(n=e[t])&&o.test(n)?n:void 0;r&&(a||(a={}),a[t]=r)}return a}function u(e){return{file:e.file,folder:e.folder,allowMultiSelect:e.allowMultiSelect}}var p=function(){function e(e,a){this._dataRequestor=a.dataRequestor}return e.prototype.getFileHandlerData=function(e){var a=e||{},n=a.language,c=void 0===n?t.default.language:n,o=a.accessToken,d=void 0===o?void 0:o,p=a.endpoint,f=void 0===p?"":p,b=a.includePromotedApp,v=void 0!==b&&b,m=a.driveId,y=void 0===m?void 0:m,g=f+"/drive";return y&&(g="me"===y?f+"/me/drive":f+"/drives/"+y),this._dataRequestor.send({path:g+"/apps?"+(v?"select=*,promoted&":"")+"$expand=actions",apiName:"GetDriveApps",headers:{"Accept-Language":c},accessToken:d,useAuthorizationHeaders:!!d}).then((function(e){for(var a={custom:[],create:[],open:[],preview:[]},n={},t=0,c=e.value;t<c.length;t++){var o=c[t];if(r(o)){var d=v?i(o):void 0,p=o.application,f=o.id,b=o.actions,m=o.fileHandler;if(b){var y=m.fileTypeDisplayName,g=m.fileTypeIconUrl,h=m.version;if(h)for(var w={id:f,appId:p.id,actionMenuDisplayName:m.actionMenuDisplayName,displayName:p.displayName,appIcon:l(m.appIcon),version:h,fileTypeDisplayName:y,fileTypeIcon:l(m.fileTypeIcon||{png1x:g}),isPromoted:d},I=0,O=0,_=b;O<_.length;O++){var k=_[O],N=k.url;if(N&&s(N)){var j=k.displayName,D=k.shortDisplayName,H=k.icon,T=k.availableOn;if(T){var x="newFile"===k.type?"create":k.type,P={type:x,url:N,displayName:j,icon:l(H),availableOn:u(T),handler:w,id:I},F=T.file,E=F&&F.extensions;switch(x){case"custom":if(!j)continue;if(P.shortDisplayName=D,!F&&!T.folder)continue;break;case"create":if(!E||!E[0])continue;break;case"open":case"preview":if(!F)continue;if(E&&!d)for(var R=0,z=E;R<z.length;R++){var A=z[R];(n[A]||(n[A]={open:[],preview:[]}))[x].push(P)}break;default:continue}a[x].push(P),I++}}}}}}return{actions:a,preferences:n,version:4}}))},e}();a.default=p},"7b223abae5848883f70b":function(e,a,n){"use strict";n.d(a,"b",(function(){return r})),n.d(a,"h",(function(){return i})),n.d(a,"g",(function(){return c})),n.d(a,"a",(function(){return o})),n.d(a,"c",(function(){return s})),n.d(a,"e",(function(){return d})),n.d(a,"d",(function(){return l})),n.d(a,"f",(function(){return u}));var t=n("447964f318fe44ff3682"),r=new t.a("fileHandlerActions"),i=new t.a("fileHandlerVersion"),c=new t.a("handlerKeyFacet"),o=new t.a("fileHandlerActionAvailableOn"),s=new t.a("fileHandlerAppIcon"),d=new t.a("fileHandlerFileTypeIcon"),l=new t.a("fileHandlerAppId"),u=new t.a("fileHandlerIsPromoted")},d561f8ff8657ef6678b9:function(e,a,n){"use strict";n.r(a),n.d(a,"fileHandlerGetItemsOperationHandler",(function(){return I})),n.d(a,"filehandlerPerExtensionGetItemsOperationHandler",(function(){return O}));var t=n("98bae3dbabd51089d613"),r=n("680b7ac74280293b48f0"),i=n("5f6c4af8cb56376acb4d"),c=n("c70c28d41140929c0281"),o=n("5fef64b3561abb2ebffa"),s=n("fdbcb7664c17b5b4e4d9"),d=n("87e95cd1ff4b249d307f"),l=n("6e15b94262f5115185b6"),u=n.n(l),p=n("6dec44e5485412f70439"),f=n("3bbe42d2eda1d0f5d766"),b=n("c07a670eeb235a1a544c"),v=n("7b223abae5848883f70b"),m=n("8f99e6f92d80fbcf38ae"),y=n("3d240143e32215cc23a5"),g=n("fcf654cc44d7ec457fe0"),h=n("eba1a54870ffae1e61c2"),w=n("6f8ae5b6dc470397fb69"),I=Object(r.e)()((function(e){var a=this,n=e.itemKey,r=b.b.deserialize(n),c=r.endpoint,o=r.driveId;return function(e){return t.__awaiter(a,void 0,void 0,(function(){var a,r,s,l,I,O,N,j,D,H;return t.__generator(this,(function(T){switch(T.label){case 0:return a=e(Object(h.a)({name:"getFileHandlersOperation"})),r={endpoint:c},s=e(Object(y.a)({getUserOneDriveEndpoint:m.f,useOneDriveEndpoint:m.p})),l=s.getUserOneDriveEndpoint,I=s.useOneDriveEndpoint,O=c,l&&I?(N=new g.SimpleUri(c).authority,j=g.SimpleUri.bind,[4,e(l.getUserOneDriveEndpoint(N))]):[3,2];case 1:O=(new(j.apply(g.SimpleUri,[void 0,T.sent()]))).authority+"/_api/v2.0",T.label=2;case 2:return D=new u.a({},{dataRequestor:e(p.b).dataRequestor}),r.fileHandlerRequestEndpoint=O,[4,e(Object(f.a)(O))];case 3:return H=T.sent(),r.accessTokenObtained=!0,[2,D.getFileHandlerData({accessToken:H,endpoint:O,includePromotedApp:!0,driveId:o}).done((function(o){var s;if(o){var d=o.actions,l=o.preferences,u=o.version,p=new i.a,f=function(e,a){var n={};return["custom","create","open","preview"].forEach((function(t){var r=_(e,a[t],t);n[t]=r})),n}(p,d),m=function(e,a){for(var n,r=new i.a,c=0,o=Object.keys(e);c<o.length;c++){var s=o[c],d=e[s],l={};l.open=_(r,d.open,"open",s),l.preview=_(r,d.preview,"preview",s);for(var u=(d.open||[]).concat(d.preview||[]),p=void 0,f=0;f<u.length;f++){var m=u[f],y=m.handler,g=m&&k(m.icon)||y&&k(y.fileTypeIcon),h=y.fileTypeDisplayName||y.displayName;if(g){p={displayName:h,url:g};break}}var w=b.a.serialize({endpoint:a,extension:s});r.resolveItems({items:(n={},n[w]=t.__assign({},v.b.pack(l),v.e.pack(p)),n)})}return{preferencesItemResolver:r}}(l,c).preferencesItemResolver;p.merge(m),p.resolveItems({items:(s={},s[n]=t.__assign({},v.b.pack(f),v.h.pack(u)),s)}),e(p.execute()),e(a({resultType:w.ResultTypeEnum.Success,extraData:r}))}}),(function(n){d.default.logError(n),e(a({resultType:w.ResultTypeEnum.Failure,extraData:r}))}))]}}))}))}})),O=Object(r.e)()((function(e){var a=this,n=e.itemKey,r=b.a.deserialize(n).endpoint;return function(e){return t.__awaiter(a,void 0,void 0,(function(){var a;return t.__generator(this,(function(n){switch(n.label){case 0:return a=b.b.serialize({endpoint:r}),[4,e(Object(c.demandItems)((function(e){return e.demandItemFacet(v.b,a)})))];case 1:return n.sent(),[2]}}))}))}}));function _(e,a,n,r){var i,c=[];a.forEach((function(a){var n,r=a.handler,i=b.e.serialize({id:r.id,appId:r.appId}),s=b.c.serialize({handlerId:r.id,appId:r.appId,id:a.id||0}),d={displayName:r.actionMenuDisplayName,url:k(r.appIcon)},l={displayName:r.fileTypeDisplayName||r.displayName,url:k(a.icon||r.fileTypeIcon)};e.resolveItems({items:(n={},n[i]=t.__assign({},o.displayNameFacet.pack(r.actionMenuDisplayName||r.displayName),v.c.pack(d)),n[s]=t.__assign({},o.displayNameFacet.pack(a.displayName||r.displayName),o.openUrlFacet.pack(a.url),v.a.pack(a.availableOn),v.g.pack(i),v.e.pack(l),v.d.pack(r.appId),void 0!==r.isPromoted?t.__assign({},v.f.pack(r.isPromoted)):{}),n)}),-1===c.indexOf(s)&&c.push(s)}));var d=b.d.serialize({type:n,extension:r});return e.resolveItems({items:(i={},i[d]=t.__assign({},s.a.pack({itemKeys:c})),i)}),d}function k(e){var a=window.devicePixelRatio||1;return e&&(e.svg||a>=1.75&&e.png2x||a>=1.25&&e.png1_5x||e.png1x)}},f454982ae5b36fa2ce04:function(e,a,n){"use strict";n.r(a),n.d(a,"driveItemDeleteItemsBatchedOperationHandler",(function(){return m}));var t,r=n("98bae3dbabd51089d613"),i=n("56aac858adc5742217b8"),c=n("680b7ac74280293b48f0"),o=n("a8e6b7a995d18a3083b6"),s=n("638c4a826f3cd38b4e52"),d=n("3da5d317c00adfe8f79c"),l=n("4e318b84c4772f9f58b9"),u=n("d27387ede93a2620cbf6"),p=n("5fef64b3561abb2ebffa"),f=n("4fab54035bc77294dc42"),b=n("6dec44e5485412f70439"),v=n("a9dd204dd0bee7467912");!function(e){e.Completed="completed",e.Failed="failed",e.InProgress="inProgress"}(t||(t={}));var m=Object(c.c)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,a){var n=f.a.deserialize(e.itemKey).driveId,t=f.a.deserialize(a.itemKey).driveId;return!!n&&!!t&&n===t}})((function(e){var a=this,n=e.items,m=Object.keys(n),y=m.map((function(e){return f.a.deserialize(e)}));return function(e){return r.__awaiter(a,void 0,void 0,(function(){var a,f,g,h,w,I,O;return r.__generator(this,(function(_){switch(_.label){case 0:return e(Object(l.a)({items:Object(s.b)(n,(function(e){e.progressItemKey;return r.__assign({},d.r.pack({total:1,current:0}),d.o.pack(!0))}),(function(e,a){return a.progressItemKey}))})),a={value:y.map((function(e){return{id:e.itemId,deleted:{}}}))},f="",g=Object(b.d)(y[0]),[4,e(Object(b.f)({url:g+"/items",method:"PATCH",body:a,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){f=e.getResponseHeader("Location")||""}}))];case 1:_.sent(),h=0,w=!1,I=!1,Object(o.wait)(3e5).then((function(){return I=!0})),O=function(){var a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,e(Object(b.f)({url:f,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:return a=r.sent(),m.forEach((function(){e(Object(l.a)({items:Object(s.b)(n,(function(e){e.progressItemKey;return d.r.pack({total:1,current:a.percentageComplete/m.length})}),(function(e,a){return a.progressItemKey}))}))})),a.status!==t.Completed&&a.status!==t.Failed?[3,2]:(w=!0,h=a.summary.failed,[3,4]);case 2:return[4,Object(o.wait)(500)];case 3:r.sent(),r.label=4;case 4:return[2]}}))},_.label=2;case 2:return[5,O()];case 3:_.sent(),_.label=4;case 4:if(!w&&!I)return[3,2];_.label=5;case 5:if(I)throw new i.a({facets:r.__assign({},v.h.pack(408))});if(e(Object(u.b)({items:Object(s.a)(m,(function(){return[p.deletedFacet]}))})),h>0)throw new c.a({items:Object(s.a)(m.slice(0,h),(function(){return new i.a({facets:r.__assign({},v.h.pack(500))})}))});return[2]}}))}))}}))}}]);