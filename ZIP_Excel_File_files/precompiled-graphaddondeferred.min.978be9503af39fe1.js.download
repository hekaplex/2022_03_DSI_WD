(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[45],{"0dcb4ef0c72818ebbce5":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("6631b0451e9f577f414d"),n=a("8e315e7d1c81f1fe46e0"),o=a("256c2b1df06b9b785912"),i=a("0b8514f932f40951d460"),c=a("c1a09d7dd35e11297e15"),s=function(){function e(e,t){var a=t.asyncType,i=void 0===a?r.default:a,c=t.eventGroupType,s=void 0===c?n.default:c,u=t.targetWindow,d=void 0===u?window:u,l=this._scope=new o.default;this._async=l.attach(new i(this)),this._events=l.attach(new s(this)),this._targetWindow=d}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.wait=function(e){var t,a=e.duration,r=e.allowWakeWhenOnline,n=void 0!==r&&r,o=this._async,s=this._events,u=this._targetWindow,d=new c.default((function(){o.clearTimeout(t)})),l=function(){n&&d.complete()};return t=o.setTimeout((function(){d.complete()}),a),s.on(u,"online",l),d.getPromise().then((function(){s.off(u,"online",l)}),(function(e){return s.off(u,"online",l),i.default.reject(e)}))},e}();t.UploadWaiter=s},"26a436222c7071f5071f":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=new(a("264a40ebead766e0e784").ControlFacet)("itemThumbnailControl")},"28d43522af463e91e061":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("98bae3dbabd51089d613"),n=a("0b8514f932f40951d460"),o=a("a24d70c7702f13f024d9"),i=a("4e087ea06522888b2152"),c=function(){function e(e,t){var a=t.uploadService,r=t.uploadStateMachine,n=t.useStreamingUpload,o=void 0!==n&&n;this._uploadService=a,this._uploadStateMachine=r,this._useStreamingUpload=o}return e.prototype.upload=function(e){var t=e.conflictBehavior,a=r.__rest(e,["conflictBehavior"]),c=a.qosData,s=new i.Qos({name:"VroomUploader.upload",extraData:c});return this._uploadState(a,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then((function(e){return s.end({resultType:i.ResultTypeEnum.Success}),e}),(function(e){return s.end({resultType:n.default.isCanceled(e)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,error:e.message,resultCode:o.getResultCodeFromError(e),extraData:r.__assign({},c,o.getQosExtraDataFromError(e))}),n.default.reject(e)}))},e.prototype._uploadState=function(e,t){var a=this,r=t.sessionUrl,o=t.item,i=t.error;if(o)return n.default.resolve(o);if(i){var c=void 0;return r&&(c=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:r}).then((function(){}),(function(){}))),n.default.resolve(c).then((function(){return n.default.reject(i)}))}return this._uploadStateMachine.advanceState(e,t).then((function(t){return a._uploadState(e,t)}))},e}();t.Uploader=c,t.default=c},"39db02180d2ec50cbbfb":function(e,t,a){"use strict";a.r(t),a.d(t,"graphAddonDeferred",(function(){return Ke}));var r,n=a("680b7ac74280293b48f0"),o=a("022addba5cf25ce091fb"),i=a("af8a4648dd318553c2f2"),c=a("3668a961dfce97a62ec8"),s=a("95da7825c4969f34e250"),u=a("902f37ccb11735819b88"),d=a("724c57678974b123bec4"),l=a("275976081ce1abf67779"),f=a("447964f318fe44ff3682"),m=a("95669b451bb4fedaf15d"),p=a("98bae3dbabd51089d613"),b=a("8969534cb3aba99e7c3a"),h=a("801b679406aabac77627"),v=a("fcf0c1042bbdc766028e"),g=a("f5df325953ebb7f1143d"),_=a("0a6fcc9f9518a7fcc53b"),y=a("5cf28e236c4257d408f7"),S=a("5fef64b3561abb2ebffa"),w=a("958db96f3e5e5318cd6e"),I=a("de961921ff36ea23aa69"),F=a("638c4a826f3cd38b4e52"),O=a("bb1ad009e1d0371a2be6"),E=a("44e6ed3c2eaab3f422db"),T=a("e75d371903c4d34a93e5"),j=a("cbd3c20d233b105c7895"),x=a("800956ab6ff71efe3834"),C=Object(w.createItemCacheComponent)((function(e,t){var a=t.itemKeys,r=t.removeFromSharedListWizard,n=t.removeItemsFromSharedList,o=void 0===n?y.b:n,i=Object(I.a)(e)||"";if(0===a.length)return null;for(var c=a.length<=200,s=r,u=0,d=a;u<d.length;u++){var f=d[u],m=e.demandItemFacet(j.a,f);j.a.evaluate(m)(e,{itemKey:f,isAvailable:!1}).isAvailable||(c=!1)}var b=e.dispatch,h=function(){return p.__awaiter(void 0,void 0,void 0,(function(){var e,t;return p.__generator(this,(function(r){switch(r.label){case 0:return e={itemSetKey:i},t=Object(F.a)(a,(function(){return e})),[4,b(o({items:t}))];case 1:return r.sent(),[2]}}))}))},v=Object(O.renderComponentOnExecute)((function(e){return l.createElement(s,p.__assign({},e,{onItemRemoved:h,itemKeys:a}))}));return l.createElement(E.a,p.__assign({isAvailable:c,onExecute:v},Object(x.getItemActionEngagement)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:a.length}}})))})),R=Object(T.withSelectedItems)()(C),D=a("4986dedaa57d766e48bb")._9qgANGID0mrw6AApMqeriQ,U=a("4986dedaa57d766e48bb")._u2MwtU5vNsDaewBTKcTptg,k=a("d6e6a1e726db94fe6759"),N=a("3da5d317c00adfe8f79c"),q=a("9c98f89a0e31dc353072"),z=((r={})[N.d.started]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeStartedItemsTitle,U.removeCompletedItemsTitleIntervals,e)||"",e)},r[N.d.completed]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeCompletedItemsTitle,U.removeCompletedItemsTitleIntervals,e)||"",e)},r[N.d.failed]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeFailedItemsTitle,U.removeFailedItemsTitleIntervals,e)||"",e)},r[N.d.canceled]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeFailedItemsTitle,U.removeFailedItemsTitleIntervals,e)||"",e)},r),K=Object(n.b)((function(){return function(e){e(Object(s.c)(y.a,q.a)(Object(s.a)()(A)))}}));function A(){return function(e){return B}}function B(e,t){var a,r=Object(g.e)(e,t),n=r.phase,o=r.count;return a=z[n](o),p.__assign({},a?{title:a}:{})}var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.resolve,r=t.reject,n=t.onItemRemoved,o=t.itemKeys,i=function(){return p.__awaiter(e,void 0,void 0,(function(){return p.__generator(this,(function(e){switch(e.label){case 0:return a(),[4,n()];case 1:return e.sent(),[2]}}))}))},c=function(){return p.__awaiter(e,void 0,void 0,(function(){return p.__generator(this,(function(e){return r(new b.CancelError),[2]}))}))};return l.createElement(h.WithItemCache,null,(function(e){var t=e.itemCache,a=M(t,o),r=a.title,n=a.prompt;return l.createElement(v.ConfirmationDialog,{onCancel:c,onConfirm:i,yesText:U.removeFromSharedListConfirmButtonText,noText:D.removeFromSharedListCancelButtonText,defaultToYes:!0,title:r,prompt:n})}))},t}(l.PureComponent),M=function(e,t){if(t.length>1)return{title:D.itemsTitleWithAccess,prompt:D.itemsSubTextWithAccess};if(1===t.length){var a=e.demandItemFacet(S.folderFacet,t[0]);return{title:a?D.folderTitleWithAccess:D.fileTitleWithAccess,prompt:a?D.folderSubTextWithAccess:D.fileSubTextWithAccess}}return{title:"",prompt:""}},L=Object(g.f)({operationTypeFacet:y.c,progressKeyFacet:y.a,initializeBatch:function(){return K}});var W=Object(_.a)((function(){return{removeFromSharedListWizard:P,removeItemsFromSharedList:L}}))(R),Q=a("ad509ccd8bb6781a5a82"),V={key:new f.a("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:Q.a.removeFromSharedList,action:l.createElement(m.b,null,l.createElement(W,null)),iconProps:{iconName:"Cancel"}},G=a("1d6ca65779224e04aaa8"),H=Object(s.a)()((function(){return function(e){return Z}}));var J={name:"-",key:"divider_1",itemType:G.a.Divider},Y=[u.a,d.c,d.b,J,V];function Z(e,t){return{commands:Y}}var $=a("54f60ac18fdd1d2e0628"),X=a("319d5d68379b759dd907"),ee=a("c1d047631433c6878a84"),te=Object(s.a)()((function(){return function(e){return re}}));var ae=[u.a,d.c,d.b,V,ee.a];function re(e,t){return{commands:ae}}var ne,oe=a("de455e56c423b6481855"),ie=a("0c7e5d362a9bb95e0dc2"),ce=a("072e92bba2790a1e2bca"),se=a("36d872fdf1e414343eb7"),ue=((ne={})[se.b]=!0,ne[se.d]=!0,ne[ce.e]=!0,ne[ce.a]=!0,ne[ce.d]=!0,ne),de=Object(s.a)()((function(){return function(e){return le}}));function le(e,t){var a=t.itemSetKey,r=t.handler,n=r.columnKey,o=r.isAscending;if(!ue[n])return{};var i=e.demandItemFacet(oe.a,a);if(!i)return{};var c=ce.b[n];return c?{newItemSetKey:oe.a.serialize(p.__assign({},i,{sortBy:c,isAscending:o}))}:{}}var fe,me=a("1570620a5bfaa589a3b2"),pe=a("0e08eb9ea76754713936"),be=a("dbabf3ffb96f7573e1b2"),he=Object(s.a)()((function(){return function(e){return function(e,t){var a=t.itemKey,r=e.demandItemFacet(oe.a,a),n=r&&r.driveItemKey.endpoint,o=n&&Object(be.a)(e,{parentItemKey:X.a.serialize({endpoint:n}),stageItem:t.stageItem});return p.__assign({},o?{stageItem:o}:{})}}}));var ve=((fe={})[ce.e]=!0,fe[ce.a]=!0,fe),ge=Object(s.a)()((function(){return function(e){return _e}}));function _e(e,t){var a=t.itemSetKey,r=t.handler.columnKey;if(!ve[r])return{};var n=e.demandItemFacet(oe.a,a);if(!n)return{};var o=ce.b[r];return o?{newItemSetKey:oe.a.serialize(p.__assign({},n,{groupBy:o}))}:{}}var ye=Object(s.a)()((function(){return function(e){return Se}}));function Se(e,t){var a=t.itemSetKey,r=e.demandItemFacet(oe.a,a);return r?{newItemSetKey:oe.a.serialize(p.__assign({},r,{groupBy:void 0}))}:{}}var we=a("59ae8255fdedb40e8263"),Ie=Object(s.a)()((function(){return function(e){return function(e,t){return{isAvailable:!1}}}}));var Fe=Object(s.a)()((function(){return function(e){return function(e,t){return{isAvailable:!1}}}}));var Oe=a("cb1ab6a528c31e7ad576"),Ee=a("ce1d17d6147b094ebc27"),Te=a("be9ddcf0ec56bc42b1b1"),je=a("5f6c4af8cb56376acb4d"),xe=a("3d240143e32215cc23a5"),Ce=a("8f99e6f92d80fbcf38ae"),Re=a("6dec44e5485412f70439"),De=a("959d5e23f32a2e71cc99"),Ue=new De.a("topCollaboratorItemKeyFacet",{id:Object(De.f)()}),ke=a("4e318b84c4772f9f58b9"),Ne=a("98da34addf7164483ddc"),qe=a("fdbcb7664c17b5b4e4d9"),ze=Object(n.e)()((function(e){var t=this,a=e.itemKey;return function(r){return p.__awaiter(t,void 0,void 0,(function(){var t,n,o,i,c,s,u,d,l,f,m,b,h,v,g,_;return p.__generator(this,(function(y){switch(y.label){case 0:return o=new je.a,i=r(Object(xe.a)({graphEndpoint:Ce.g})).graphEndpoint,c=Ee.a.deserialize(a),s=i||c.endpoint,u=s+"/me/people/?$top=3",[4,r(Object(Re.f)({url:u,qosName:"getTopCollaborator",endpoint:s}))];case 1:for(d=y.sent(),l=[],f=0,m=d.value;f<m.length;f++)b=m[f],h=b.id,v=b.displayName,g=b.userPrincipalName,_=Ue.serialize({id:h}),r(Object(ke.a)({items:(t={},t[_]=p.__assign({},S.displayNameFacet.pack(v),Ne.emailFacet.pack(g)),t)})),l.push(_);return o.resolveItems({items:(n={},n[e.itemKey]=p.__assign({},qe.a.pack({itemKeys:l})),n)}),r(o.execute()),[2]}}))}))}}));var Ke=Object(n.b)((function(){return function(e){e(Object(Oe.a)((function(){e($.graphAddonDataOnlyDeferred),e(Object(s.c)(X.a,i.a)(te)),e(Object(s.c)(X.a,c.a)(H)),e(Object(s.c)(oe.a,ie.a)(de)),e(Object(s.c)(oe.a,me.a)(he)),e(Object(s.c)(oe.a,pe.a)(ge)),e(Object(s.c)(oe.a,pe.b)(ye)),e(Object(s.c)(we.c,me.a)(Ie)),e(Object(s.c)(we.b,me.a)(Fe)),e(Object(o.g)(Ee.a,Te.a)(ze))})))}}))},"54f60ac18fdd1d2e0628":function(e,t,a){"use strict";a.r(t),a.d(t,"graphAddonDataOnlyDeferred",(function(){return ut}));var r=a("98bae3dbabd51089d613"),n=a("680b7ac74280293b48f0"),o=a("022addba5cf25ce091fb"),i=a("95da7825c4969f34e250"),c=a("4fab54035bc77294dc42"),s=a("163bd1662ba0d8c200dc"),u=a("e87bb409a9007bb8123c"),d=a("63aeb04d7e4744f15272"),l=a("6187b1a01125644c0b13"),f=a("2807dfd01f20f29a2152"),m=a("e008263a4c0e246e4f4f"),p=a("64b1e6e25051aaaf0681"),b=a("6addfaf561d910b46fa0"),h=a("2c440e638bb16e83d44e"),v=a("26a436222c7071f5071f"),g=a("119e7fc4035eae889114"),_=a("6dec44e5485412f70439"),y=a("3da5d317c00adfe8f79c"),S=a("fdbcb7664c17b5b4e4d9"),w=a("01b70109f23a290743e9"),I=a("5f6c4af8cb56376acb4d"),F=Object(n.e)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,a=e.options.folders,n=c.a.deserialize(t),o=n.endpoint,i=n.driveId,s=n.itemId,u=Object.keys(a)[0],d=a[u].progressItemKey;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var a,l,f,m,p,b,h,v;return r.__generator(this,(function(g){switch(g.label){case 0:return m=Object(_.c)(n)+"/children",p={name:u,folder:{},"@microsoft.graph.conflictBehavior":"rename"},i&&s&&(p.parentReference={driveId:i,id:s}),[4,e(Object(_.f)({url:m,method:"POST",body:p,qosName:"createFolder",endpoint:o}))];case 1:return b=g.sent(),h=c.a.serialize({endpoint:o,driveId:i,itemId:b.id}),v=new I.a,d&&v.resolveItems({items:(a={},a[d]=r.__assign({},y.f.pack({itemKey:h})),a)}),v.invalidateItems({items:(l={},l[t]=[S.b],l)}),v.resolveItems({items:(f={},f[h]=r.__assign({},Object(w.a)({driveItem:b,parentFolderItemKey:t,endpoint:o})),f)}),e(v.execute()),[2]}}))}))}})),O=a("d27387ede93a2620cbf6"),E=a("5fef64b3561abb2ebffa"),T=Object(n.e)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,a=c.a.deserialize(t);return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return o=Object(_.c)(a),[4,e(Object(_.f)({url:o,method:"DELETE",qosName:"deleteItem",endpoint:a.endpoint}))];case 1:return r.sent(),e(Object(O.b)({items:(n={},n[t]=[E.deletedFacet],n)})),[2]}}))}))}})),j=a("56aac858adc5742217b8"),x=a("a9dd204dd0bee7467912"),C=a("578e5017557fc66bb247"),R=a("a24d70c7702f13f024d9"),D=Object(n.e)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,a=e.options.names,n=c.a.deserialize(t);return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,c,s,u,d,l;return r.__generator(this,(function(f){switch(f.label){case 0:return o=Object.keys(a)[0],i=a[o],c=i.newName,s=i.newExtension,u=Object(_.c)(n),d=e(Object(C.a)({fileName:E.fileNameFacet},t)).fileName,l="string"==typeof s?s:d&&d.extension||"",[4,e(Object(_.f)({url:u,method:"PATCH",body:{name:""+c+l},qosName:"renameItem",endpoint:n.endpoint})).then((function(a){var n,o,i=new I.a;i.invalidateItems({items:(n={},n[t]=[E.displayNameFacet],n)}),i.resolveItems({items:(o={},o[t]=r.__assign({},E.displayNameFacet.pack(a.name),E.fileNameFacet.pack(Object(w.b)(a.name||"",!!a.folder))),o)}),e(i.execute())})).catch((function(e){if(e instanceof R.GraphError&&e.status===j.b)throw new j.a({facets:r.__assign({},x.m.pack({})),innerError:e});throw e}))];case 1:return f.sent(),[2]}}))}))}})),U=a("28d43522af463e91e061"),k=a("e98307e3d02bf06255ee"),N=a("0dcb4ef0c72818ebbce5"),q=a("c3cad731bb834f32ee95"),z=a("aed6969132a8e15168e7"),K=a("3bbe42d2eda1d0f5d766"),A=a("2be4cdf0880f45f00879"),B=a("3560af8f1e8ae6e7a04f"),P=a("eef09ec91afb2fd77b66"),M=a("c21819129ba64362c121"),L=a("4e318b84c4772f9f58b9"),W=a("447964f318fe44ff3682"),Q=a("0b8514f932f40951d460"),V=a("8969534cb3aba99e7c3a"),G=Object(B.a)((function(){return new N.UploadWaiter({},{})})),H=Object(B.a)((function(e){var t=e(_.b).dataRequestor,a=function(e){function t(t){return e.call(this,t,{performanceNow:z.performanceNow})||this}return r.__extends(t,e),t}(z.ActivityBandwidthVerifier),n=new k.UploadService({},{dataRequestor:t}),o=new q.UploadStateMachine({},{activityBandwidthVerifierType:a,uploadService:n});return new U.Uploader({},{uploadService:n,uploadStateMachine:o})})),J=0,Y=Object(n.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})((function(e){var t=this,a=e.itemKey,n=e.options.sourceEntries,o=c.a.deserialize(a),i=o.endpoint,s=o.driveId,u=Object.keys(n)[0],d=n[u].progressItemKey;return function(e){return r.__awaiter(t,void 0,void 0,(function(){var t,n,l,f,m,p,b,h,v;return r.__generator(this,(function(g){switch(g.label){case 0:if(!(m=e(Object(C.a)({sourceFile:M.b},u)).sourceFile))throw new Error("No source file for Graph upload.");return p=Object(_.c)(o)+":",d&&e(Object(L.a)({items:(t={},t[d]=r.__assign({},y.r.pack({total:m.size,current:0})),t)})),[4,e(Z({progressItemKey:d,sourceFile:m,itemUrl:p,endpoint:i}))];case 1:return b=g.sent(),h=c.a.serialize({endpoint:i,driveId:s,itemId:b.id}),v=new I.a,d&&v.resolveItems({items:(n={},n[d]=r.__assign({},y.f.pack({itemKey:h}),Object(W.d)({progressSize:y.r},{progressSize:{current:m.size}})),n)}),v.invalidateItems({items:(l={},l[a]=[S.b],l)}),v.resolveItems({items:(f={},f[h]=r.__assign({},Object(w.a)({driveItem:b,parentFolderItemKey:a,endpoint:i})),f)}),e(v.execute()),[2]}}))}))}}));function Z(e){var t=this,a=e.progressItemKey,n=e.sourceFile,o=e.itemUrl,i=e.endpoint;return function(e){return r.__awaiter(t,void 0,void 0,(function(){var t,c,s,u,d,l,f,m,p,b;return r.__generator(this,(function(r){switch(r.label){case 0:return t=e(H),c=e(G),[4,e(Object(K.a)(i))];case 1:s=r.sent(),u=new A.a,d=0,l=u.debounce((function(t){var r;t>d&&(a&&e(Object(L.a)({items:(r={},r[a]=Object(W.d)({progressSize:y.r},{progressSize:{current:t}}),r)})),d=t)}),300,{leading:!1}),f=e(Object(P.a)((function(e){return e.demandItemFacet(y.e,a)}))),m=t.upload({conflictBehavior:"fail",qosData:{uploadId:""+ ++J},accessToken:s,fileName:n.name,content:n,itemUrl:o,onProgress:l,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return c.wait(e)}}),p=f?f.token.subscribe((function(){m.cancel()})):void 0,r.label=2;case 2:return r.trys.push([2,4,5,6]),[4,m];case 3:return[2,r.sent()];case 4:if(b=r.sent(),Q.default.isCanceled(b))throw new V.CancelError;throw b;case 5:return p&&p(),u.dispose(),[7];case 6:return[2]}}))}))}}var $=a("3c5e58fee5b0e3275498"),X=a("36e2fbcb644dd53b7016"),ee=a("f5454705d9d5f89bad27"),te=a("e66c59a0c38d59122168"),ae=a("2852e19dad7ee30e33c6"),re=(new te.a("addToOneDrive",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.a}))})),new te.a("canCreateFolder",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.b}))}))),ne=(new te.a("canCreateLink",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.c}))})),new te.a("canDelete",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.d}))}))),oe=new te.a("canDownload",(function(e,t){return!e.demandItemFacet(ae.c,t.itemKey)&&se(e,r.__assign({},t,{commandFacet:X.e}))})),ie=(new te.a("canInvite",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.f}))})),new te.a("canMove",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.g}))})),new te.a("canUseOfficeLens",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.h}))})),new te.a("canRename",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.i}))}))),ce=new te.a("canUpload",(function(e,t){return se(e,r.__assign({},t,{commandFacet:X.j}))}));function se(e,t){var a=t.itemKey,r=t.commandFacet,n=e.demandItemFacet(c.a,a);if(!n)return!1;var o=n.endpoint,i=n.driveId,s=e.demandItemFacet(r,ee.a.serialize({endpoint:o,driveId:i}));return!!s&&!!s.roles&&function(e,t){var a=t.itemKey,r=t.oneOfRequiredRoles,n=function(e,t){if(function(e,t){var a=e.demandItemFacet($.a,t);return!a||!a.effectiveRoles||!a.owner}(e,t))return["read","write","owner"];var a=e.demandItemFacet($.a,t);if(a&&a.effectiveRoles)return a.effectiveRoles;return[]}(e,a);return function(e,t){var a=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var n in r)if(n in a)return!0;return!1}(0,{oneOfRequiredRoles:r,effectiveRoles:n})}(e,{itemKey:a,oneOfRequiredRoles:s.roles})}var ue=Object(i.a)()((function(){return function(){return function(e,t){var a=t.itemKey;return{isAvailable:e.demandItemFacet(re,a)}}}}));var de=a("cfef2ab49d0d7bc1e869"),le=Object(i.a)()((function(){return function(){return function(e,t){var a=t.itemKey;return{isAvailable:e.demandItemFacet(ie,a),validator:de.a}}}}));var fe=Object(i.a)()((function(){return function(){return function(e,t){var a=t.itemKey;return{isAvailable:e.demandItemFacet(ne,a)}}}}));var me=Object(i.a)()((function(){return function(){return function(e,t){var a=t.itemKey;return{isAvailable:e.demandItemFacet(ce,a)}}}}));var pe=Object(i.a)()((function(){return function(e){return be}}));function be(e,t){if(1!==t.itemKeys.length)return{};var a=t.itemKeys[0];if(e.demandItemFacet(E.folderFacet,a))return{};var n=e.demandItemFacet(c.a,a),o=n?Object(_.c)(n):void 0,i=n&&n.endpoint||"";return{isAvailable:e.demandItemFacet(oe,a),getDownloadData:o?function(){return function(e){var t=this,a=e.itemUrl,n=e.endpoint;return function(o){return r.__awaiter(t,void 0,void 0,(function(){var t,i,c,s;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o(Object(_.f)({url:e.itemUrl,method:"GET",qosName:"getItemDownloadUrl",endpoint:n}))];case 1:if(t=r.sent(),!(i=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(a)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:i}];case 2:throw(c=r.sent())instanceof R.GraphError?(s=Object(R.getErrorResolution)(c,(function(e,t){switch(e){case"unauthenticated":case 401:return x.b.pack({});case"itemNotFound":case 404:return x.f.pack({});case"accessDenied":case 403:return x.a.pack({});default:return x.m.pack({})}})),new j.a({innerError:c,facets:s})):c;case 3:return[2]}}))}))}}({itemUrl:o,endpoint:i})}:void 0}}var he=Object(i.a)()((function(){return function(e){return ve}}));function ve(e,t){var a=t.itemKey,n=e.demandItemFacet(c.a,a);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(a){return r.__awaiter(t,void 0,void 0,(function(){var t,n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return(t=e.driveItem)?(n=Object(_.c)(t)+"/invite",[4,a(Object(_.g)({url:n,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}}))}))}}({driveItem:n})}}}var ge=Object(i.a)()((function(){return function(){return function(){return{}}}}));var _e=Object(i.a)()((function(){return function(e){return ye}}));function ye(e,t){var a=t.itemKey,n=t.link,o=t.recipients,i=e.demandItemFacet(c.a,a);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(a){return r.__awaiter(t,void 0,void 0,(function(){var t,n,o,i,c,s,u,d,l,f,m,p;return r.__generator(this,(function(r){switch(r.label){case 0:if(t=e.driveItem,n=e.link,o=e.recipients,!t||!n)throw new Error("Unable to obtain default share URL");return i=t.endpoint,s=btoa(n),c="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),u=o.map((function(e){return{email:e}})),d={recipients:u,roles:["read"]},l=i.replace("v1.0","beta"),f=l+"/shares/"+c+"/permission/grant",[4,a(Object(_.g)({url:f,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:d}))];case 1:return m=r.sent(),p=m.value[0].grantedToIdentities.map((function(e){return{email:e.user.email}})),[2,{recipients:p}]}}))}))}}({driveItem:i,link:n,recipients:o})}}}var Se=a("1bf44020f3901b4e05c2"),we=Object(i.a)()((function(){return function(e){return Ie}}));function Ie(e,t){var a=t.itemKey,r=t.desiredSize,n=e.demandItemFacet(c.a,a),o=function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t}(e.demandItemFacet(Se.a,a));return n&&o&&o.large?{thumbnail:{url:Ee(o.large.url,r),width:0,height:0}}:{}}var Fe=/width=[0-9]*/,Oe=/height=[0-9]*/;function Ee(e,t){var a=""+(t.width||"");Fe.test(e)?e=e.replace(Fe,"width="+a):e+=(e.indexOf("?")>-1?"&":"?")+"width="+a;var r=""+(t.height||"");return Oe.test(e)?e=e.replace(Oe,"height="+r):e+=(e.indexOf("?")>-1?"&":"?")+"height="+r,e}var Te=a("664990b3cc9463570172"),je=a("7a458e85783b71176e85"),xe=a("38b5b26773d7dabe2878"),Ce=a("8f99e6f92d80fbcf38ae"),Re=a("3d240143e32215cc23a5"),De=Object(n.e)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,a=e.options,n=a.isFollowed,o=a.progressItemKey,i=xe.a.deserialize(t),s=i.driveItemKey,u=s.itemId,d=void 0===u?"":u;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var t,a,u,l,f,m,p,b,h,v,g;return r.__generator(this,(function(S){switch(S.label){case 0:l=e(Object(Re.a)({useGraphEndpointForSavedForLater:Ce.o,graphEndpoint:Ce.g})),f=l.useGraphEndpointForSavedForLater,m=l.graphEndpoint,p=new I.a,b=xe.a.serialize(i),h=f&&m?m:s.endpoint,o&&e(Object(L.a)({items:(t={},t[o]=r.__assign({},y.s.pack({itemKey:c.a.serialize(s)})),t)})),v=n?{url:h+"/drives/"+s.driveId+"/items/"+d+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+s.driveId+"/following/"+d,method:"DELETE",qosName:"unfollowItem"},S.label=1;case 1:return S.trys.push([1,3,,4]),[4,e(Object(_.f)({url:v.url,method:v.method,qosName:v.qosName,endpoint:h}))];case 2:return S.sent(),p.invalidateItems({items:(a={},a[b]=[E.isFollowedFacet],a)}),p.resolveItems({items:(u={},u[b]=r.__assign({},E.isFollowedFacet.pack(n)),u)}),e(p.execute()),[3,4];case 3:throw g=S.sent(),new Error(g.message);case 4:return[2]}}))}))}})),Ue=a("202cbd74e3f23ed02585"),ke=a("e03a358d7e9a80ade819"),Ne=a("7e3c1a3ef9a4a6f39fb9"),qe=a("d6c3da553edc07112fb2");function ze(e,t){return qe.a.serialize(r.__assign({},{driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Ke=Object(i.a)()(Be),Ae=Object(i.a)()(Be);function Be(){return function(e){return function(e,t){var a,r=t.itemKey,n=e.demandItemFacet(Ne.a,r);if(n)a=function(e){return n?ze(n,e):void 0};else{var o=e.demandItemFacet(qe.a,r);a=function(e){return o?ze(o,e):void 0}}return{isAvailable:!0,getSearchItemKey:a}}}}var Pe=a("db48f6075c5eb63351b0"),Me=a("094e1535cff726648423"),Le=a("004c1cdbe696eacb8020"),We=Object(i.a)()((function(){return function(e){return Qe}}));function Qe(e,t){var a=t.handlers,n=t.itemKey,o=e.demandItemFacet(Ne.a,n),i=e.demandItemFacet(qe.a,n);if(a&&(o||i)){for(var c=[],s=0,u=a;s<u.length;s++){var d=u[s];if(d.key===Le.g.key)c.push("photo");else if(d.key===Le.h.key)c.push("video");else if(d.key===Le.a.key)c.push("folder");else if(d.key===Le.f.key)c.push("onenote");else if(d.key===Le.d.key)c.push("!photo");else if(d.key===Le.e.key)c.push("!video");else if(d.key===Le.b.key)c.push("!folder");else if(d.key===Le.c.key)c.push("!onenote");else{var l=Object(Me.a)(d);l&&c.push(l)}}if(o)return{itemKey:Ne.a.serialize(r.__assign({},o,{extFilters:c}))}}return{}}var Ve=a("9ec68841fe22535372ee"),Ge=a("c70c28d41140929c0281"),He=a("e13c588884262941567a"),Je=Object(n.e)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,a=e.options,n=Object.keys(a)[0];return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,s,u,d,l,f,m,p;return r.__generator(this,(function(b){switch(b.label){case 0:if(!e(Object(P.a)((function(e){return e.demandItemFacet(c.a,n)}))))throw new Error("Source item does not have a driveItem key");return i=a[n],s=i.isMove,u=i.conflictBehavior,d=c.a.deserialize(t),[4,e(Object(Ge.demandItems)((function(e){return e.demandItemFacet(c.a,n)})))];case 1:if(!(l=b.sent()))throw new Error("Unable to get metadata for destination item.");f=Object(_.c)(l),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,e(Object(_.f)({url:f+(s?"":"/copy"),method:s?"PATCH":"POST",body:{parentReference:{id:d.itemId||He.c,driveId:d.driveId||""},"@microsoft.graph.conflictBehavior":u},qosName:s?"moveItem":"copyItem",endpoint:d.endpoint}))];case 3:return b.sent(),(m=new I.a).invalidateItems({items:(o={},o[n]=s?[E.parentFolderItemFacet,E.deletedFacet]:[],o[t]=[S.b],o)}),e(m.execute()),[3,5];case 4:if((p=b.sent())instanceof R.GraphError&&p.status===j.b)throw new Ve.a({innerError:p,facets:r.__assign({},x.h.pack(p.status))});throw p;case 5:return[2]}}))}))}})),Ye=a("df48e25b04ff6342ce7b"),Ze=Object(i.a)()((function(){return function(){return function(e,t){return{validator:de.a}}}}));var $e=a("894f2391cc313a7da701"),Xe=a("e17f546ab8812a549d96"),et=a("b28cff7ca93cb4538809"),tt=a("be9ddcf0ec56bc42b1b1"),at=a("cc6309d2463e503ef82c"),rt=a("cb1ab6a528c31e7ad576"),nt=a("29171b69bc1396c71276"),ot=a("de455e56c423b6481855"),it=a("f4ada3c3607c09804e69"),ct=Object(n.e)()((function(e){var t=e.itemKey,a=e.options.itemSetKey;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var n,o,i,s,u;return r.__generator(this,(function(r){switch(r.label){case 0:if(!ot.a.matches(a))throw new j.a({code:"invalidItemSetForAddToOneDrive"});if(n=ot.a.deserialize(a).driveItemKey.endpoint,o=e(Object(P.a)((function(e){return e.demandItemFacet(E.fileNameFacet,t)}))),i=e(Object(P.a)((function(e){return e.demandItemFacet(c.a,t)}))),!n||!o||!i)throw new j.a({code:"missingItemInfoForAddToOneDrive"});return[4,e(Object(it.c)("GetDriveInfo",n))];case 1:s=r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e(Object(it.b)(o.name,s.id,i,"AddToOneDrive_SWM",n))];case 3:return r.sent(),[3,5];case 4:if(!((u=r.sent())instanceof R.GraphError))throw u;return Object(it.a)(u),[3,5];case 5:return[2]}}))}))}})),st=Object(Xe.asModuleWithRetries)((function(){return Promise.all([a.e(8),a.e(57)]).then(a.bind(null,"f454982ae5b36fa2ce04"))}),{chunkName:"addon-graph-deferredoperations"}),ut=Object(n.b)((function(){return function(e){var t=e(Object(Re.a)({useBatchedDeleteConfiguration:Ce.n})).useBatchedDeleteConfiguration;e(Object(rt.a)((function(){e(Object(i.c)(Ne.a,ke.a)(Ke)),e(Object(i.c)(qe.a,ke.a)(Ae)),e(Object(i.c)(Ne.a,Pe.a)(We)),e(Object(o.g)(c.a,s.b)(F)),e(t?Object(o.g)(c.a,u.b)(Object(n.d)((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,e(Object($e.h)())];case 1:return t.sent(),[4,st()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}}))}))}))):Object(o.g)(c.a,u.b)(T)),e(Object(o.g)(c.a,d.b)(D)),e(Object(o.g)(c.a,l.b)(Y)),e(Object(o.g)(c.a,Ve.b)(Je)),e(Object(o.g)(c.a,nt.b)(ct)),e(Object(i.c)(c.a,f.a)(ue)),e(Object(i.c)(c.a,Ye.a)(Ze)),e(Object(i.c)(c.a,m.a)(le)),e(Object(i.c)(c.a,p.b)(fe)),e(Object(i.c)(c.a,b.a)(me)),e(Object(i.c)(c.a,Te.a)(he)),e(Object(i.c)(c.a,je.a)(_e)),e(Object(i.c)(c.a,h.a)(pe)),e(Object(i.c)(c.a,v.a)(we)),e(Object(i.c)(c.a,g.a)(ge)),e(Object(o.g)(xe.a,Ue.a)(De)),e(Object(o.g)(et.a,tt.a)(at.a))})))}}))},"5cf28e236c4257d408f7":function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return c}));var r=a("447964f318fe44ff3682"),n=a("f5df325953ebb7f1143d"),o=new r.a("removeItemsFromSharedList"),i=new n.a("removeItemsFromSharedList"),c=Object(n.f)({operationTypeFacet:o,progressKeyFacet:i})},"664990b3cc9463570172":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=new(a("264a40ebead766e0e784").ControlFacet)("getDefaultShareLinkActionControl")},"7a458e85783b71176e85":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=new(a("264a40ebead766e0e784").ControlFacet)("permissionInviteActionControl")},"9ec68841fe22535372ee":function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return u}));var r=a("98bae3dbabd51089d613"),n=a("447964f318fe44ff3682"),o=a("56aac858adc5742217b8"),i=a("f5df325953ebb7f1143d"),c=new n.a("moveCopyItems"),s=new i.a("moveCopyItems"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(o.a)},aed6969132a8e15168e7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var r=function(){function e(e,t){this._performanceNow=t.performanceNow,this._startTime=this._performanceNow(),this._expirationTime=this._startTime+e.timeout,this._totalBytes=e.totalBytes,this._progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5},e.prototype._getRateRatio=function(e){this._progressPoints++;var t,a=this._performanceNow(),r=a-this._startTime,n=this._expirationTime-a,o=this._totalBytes-e;return(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===o)&&n>0&&(t=o/n/(e/r)),t},e}();t.ActivityBandwidthVerifier=r},c21819129ba64362c121:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));var r=a("447964f318fe44ff3682"),n=new r.a("entryBatch"),o=new r.a("sourceFile")},c3cad731bb834f32ee95:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("98bae3dbabd51089d613"),n=a("a24d70c7702f13f024d9"),o=a("4e087ea06522888b2152"),i=a("0b8514f932f40951d460"),c=a("c1a09d7dd35e11297e15"),s=Math.pow(2,1/4),u=function(){function e(e,t){this._uploadService=t.uploadService,this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var a=t.useCommitForUpload,r=void 0!==a&&a,n=t.checkForCompletedUploadOnSessionTermination,o=void 0===n||n,i=t.shouldCancelOnCompleteFailure,c=void 0===i||i,s=t.maximumFragmentSize,u=void 0===s?62914560:s;this._shouldCancelOnCompleteFailure=c,this._useCommitForUpload=r,this._checkForCompletedUploadOnSessionTermination=o,this._maximumFragmentSize=u}return e.prototype.advanceState=function(e,t){var a=this,r=t.sessionUrl,n=t.nextExpectedRanges;return(r?n?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then((function(t){return t.error?a._handleGeneralErrorState(e,t):a._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})}))},e.prototype._createSessionState=function(e,t){var a=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.createSession",extraData:i});return this._uploadService.createSession({qosData:i,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then((function(e){return c.end({resultType:o.ResultTypeEnum.Success}),a._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})}),(function(s){return a._handleCreateSessionErrorState(e,a._getState(t,{error:s})).then((function(e){return e.error?c.end({resultType:o.ResultTypeEnum.Failure,error:s.message,resultCode:n.getResultCodeFromError(s),extraData:r.__assign({},i,n.getQosExtraDataFromError(s))}):c.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),e}))}))},e.prototype._handleCreateSessionErrorState=function(e,t){var a=this;return this._handleErrorState(t,(function(r,n){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return a._promptForConflictBehaviorState(n,e,t)}}))},e.prototype._getStatusState=function(e,t){var a=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.getStatus",extraData:i});return this._uploadService.getStatus({qosData:i,sessionUrl:t.sessionUrl}).then((function(e){return c.end({resultType:o.ResultTypeEnum.Success}),a._getState(t,{nextExpectedRanges:e.nextExpectedRanges})}),(function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},i,n.getQosExtraDataFromError(e))}),a._getState(t,{error:e})}))},e.prototype._uploadItemState=function(e,t){var a=this,i=e.qosData,c=e.content.size,s=this._getNextRange({fileSize:c,nextExpectedRanges:t.nextExpectedRanges}),u=new o.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(s&&s.start<c?t.allowStreaming?this._uploadStreamState({nextRange:s},e,t):this._uploadFragmentState({nextRange:s},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then((function(t){return t.error?a._handleUploadItemErrorState(e,t).then((function(e){var t=e.error;return t?u.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:n.getResultCodeFromError(t),extraData:r.__assign({},i,n.getQosExtraDataFromError(t))}):u.end({resultType:o.ResultTypeEnum.Success}),e})):(u.end({resultType:o.ResultTypeEnum.Success}),t)}))},e.prototype._terminateUploadOnCompleteFailure=function(e){return i.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))},e.prototype._uploadFragmentState=function(e,t,a){var i=this,u=e.nextRange,d=t.onProgress,l=t.headers,f=t.content,m=t.content.size,p=t.qosData,b=a.sessionUrl,h=a.speed,v=void 0===h?1/8:h,g=u.start,_=u.end;d&&d(g);var y,S,w=this._getFragmentSize(v),I=Math.min(g+w,_),F=new c.default((function(){y&&y.cancel()})),O=v>1/1920?6e4:3e5,E=new this._activityBandwidthVerifierType({timeout:O,totalBytes:I-g}),T=new o.Qos({name:"VroomUploader.uploadFragment",extraData:r.__assign({},p,{startByte:g,endByte:I,fileSize:m,speed:v,fragmentSize:w})});return(y=this._uploadService.uploadFragment({qosData:p,headers:l,sessionUrl:b,startByte:g,endByte:I,fileSize:m,content:f.slice(g,I),timeout:O,onProgress:function(e){S=e,v>1/1920&&!E.doesActivityHaveRemainingCapacity(e-g)&&(T.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:r.__assign({},p,{lastByte:e})}),F.complete(i._getState(a,{speed:Math.max(.5*v,1/1920),nextExpectedRanges:void 0})),y&&y.cancel()),d&&d(e)}}).then((function(e){return d&&d(I),T.end({resultType:o.ResultTypeEnum.Success}),a=i._isItem(e)?i._getState(a,{item:e}):i._getState(a,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(E.didActivityHaveExtraCapacity()?v*s:v,1)})}),(function(e){return T.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},p,n.getQosExtraDataFromError(e),{lastByte:S})}),i._getState(a,{error:e})}))).done((function(e){F.complete(e)})),F.getPromise()},e.prototype._uploadStreamState=function(e,t,a){var i=this,s=e.nextRange,u=t.headers,d=t.onProgress,l=t.content,f=t.content.size,m=t.qosData,p=a.sessionUrl,b=s.start,h=s.end,v=Math.min(h-b,this._maximumFragmentSize),g=b+v;d&&d(b);var _,y=new c.default((function(){_&&_.cancel()})),S=new o.Qos({name:"VroomUploader.uploadStream",extraData:r.__assign({},m,{startByte:b,endByte:g,fileSize:f,fragmentSize:v})});return(_=this._uploadService.uploadFragment({qosData:m,headers:u,sessionUrl:p,startByte:b,endByte:g,fileSize:f,content:l.slice(b,g),timeout:864e5,onProgress:function(e){d&&d(e)}}).then((function(e){return d&&d(g),S.end({resultType:o.ResultTypeEnum.Success}),a=i._isItem(e)?i._getState(a,{item:e}):i._getState(a,{nextExpectedRanges:e.nextExpectedRanges})}),(function(e){return S.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},m,n.getQosExtraDataFromError(e),{lastByte:void 0})}),i._handleUploadStreamErrorState({nextRange:s},t,i._getState(a,{error:e}))}))).done((function(e){y.complete(e)})),y.getPromise()},e.prototype._handleUploadStreamErrorState=function(e,t,a){var r=this,n=e.nextRange;return this._handleErrorState(a,(function(e){switch(e){case 0:return r._wait({duration:1e3},t).then((function(){return r._getStatusState(t,a).then((function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>n.start?e:r._getState(a,{allowStreaming:!1})}))}))}}))},e.prototype._commitState=function(e,t){var a=this,i=e.qosData,c=e.onProgress;c&&c(e.content.size);var s=new o.Qos({name:"VroomUploader.commit",extraData:i});return this._uploadService.commit({qosData:i,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then((function(e){return s.end({resultType:o.ResultTypeEnum.Success}),a._getState(t,{item:e})}),(function(e){return a._handleCommitErrorState(a._getState(t,{error:e})).then((function(t){return s.end({resultType:t.error?o.ResultTypeEnum.Failure:o.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},i,n.getQosExtraDataFromError(e))}),t}))}))},e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,(function(a){switch(a){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return i.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}}))},e.prototype._cancelSessionState=function(e,t){var a=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.cancelSession",extraData:i});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then((function(){return c.end({resultType:o.ResultTypeEnum.Success}),a._getState(t,{sessionUrl:void 0})}),(function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},i,n.getQosExtraDataFromError(e))}),a._getState(t,{sessionUrl:void 0})}))},e.prototype._handleUploadItemErrorState=function(e,t){var a=this,r=t.speed,n=void 0===r?1:r;return t=this._getState(t,{nextExpectedRanges:void 0}),this._handleErrorState(t,(function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?i.default.resolve(a._getState(t,{allowStreaming:!1})):i.default.resolve(a._getState(t,{speed:Math.max(n*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return i.default.resolve(a._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return a._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return a._wait({duration:1e3},e).then((function(){return a._getState(t,{error:void 0})}))}}))},e.prototype._getItemIfCompletedState=function(e,t){var a=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.getItemIfCompleted",extraData:i});return this._uploadService.getItem({qosData:i,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then((function(r){return c.end({resultType:o.ResultTypeEnum.Success}),e.lastModifiedDate&&r.fileSystemInfo&&r.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&r.size===e.content.size&&"rename"!==t.conflictBehavior?a._getState(t,{item:r,error:void 0}):a._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})}),(function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},i,n.getQosExtraDataFromError(e))}),a._getState(t,{error:e})}))},e.prototype._handleGeneralErrorState=function(e,t){var a=this,r=t.waitDuration,n=void 0===r?500:r,o=t.attemptsRemaining,i=void 0===o?10:o;return this._handleErrorState(t,(function(r){switch(r){case"uploadSessionNotFound":return a._checkForCompletedUploadOnSessionTermination?a._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return a._wait({duration:n,allowWakeWhenOnline:!0},e).then((function(){return a._getState(t,{error:void 0,waitDuration:Math.min(2*n,3e4),attemptsRemaining:void 0})}));if(!i)return;return a._wait({duration:1e3},e).then((function(){return a._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(i-1,0)})}))}}))},e.prototype._handleErrorState=function(e,t){var a=e.error,r=n.getErrorResolution(a,t);return void 0===r&&(r=i.default.resolve(e)),r},e.prototype._promptForConflictBehaviorState=function(e,t,a){var c=this,s=t.onPromptForConfictBehavior,u=t.qosData,d=new o.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:u});return i.default.resolve().then((function(){return s(e)})).then((function(e){return d.end({resultType:o.ResultTypeEnum.Success,extraData:u}),c._getState(a,{error:void 0,conflictBehavior:e})}),(function(t){return d.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:n.getResultCodeFromError(e),extraData:r.__assign({},u,n.getQosExtraDataFromError(t))}),c._getState(a,{error:t})}))},e.prototype._wait=function(e,t){var a=e.duration,r=e.allowWakeWhenOnline,c=t.onWait,s=t.qosData,u=new o.Qos({name:"VroomUploader.wait",extraData:s});return i.default.resolve(c({duration:a,allowWakeWhenOnline:r})).then((function(){u.end({resultType:o.ResultTypeEnum.Success})}),(function(e){return u.end({resultType:i.default.isCanceled(e)?o.ResultTypeEnum.Success:o.ResultTypeEnum.Failure,error:e&&e.message,resultCode:n.getResultCodeFromError(e)}),i.default.reject(e)}))},e.prototype._getState=function(e,t){return r.__assign({},e,t)},e.prototype._getNextRange=function(e){var t=e.fileSize,a=e.nextExpectedRanges;return(void 0===a?[]:a).reduce((function(e,a){var r,n=a.split("-",2),o=n[0],i=n[1],c=parseInt(o,10);!e||c<e.start&&c<t?r={start:c,end:""===i?t:Math.min(parseInt(i,10)+1,t)}:r=e;return r}),void 0)},e.prototype._isItem=function(e){return!!e.id},e.prototype._getFragmentSize=function(e){var t,a=62914560*e;return t=a>327680?a-a%327680:a-a%32768,Math.min(Math.max(t,32768),this._maximumFragmentSize)},e}();t.UploadStateMachine=u},cbd3c20d233b105c7895:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r=new(a("264a40ebead766e0e784").ControlFacet)("removeFromShardListActionControl")},cfef2ab49d0d7bc1e869:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return s}));var r,n=a("d6e6a1e726db94fe6759"),o=a("4986dedaa57d766e48bb")._Qr9VWNQuRRaLzAyN3mwy4A;function i(e){return function(t){return function(e,t){switch(e){case r.InvalidCharacters:return n.format(o.invalidNameError,t.invalidCharacters);case r.InvalidStart:return n.format(o.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return n.format(o.invalidNameEndError,t.cannotEndWith);case r.Empty:return o.emptyNameError;case void 0:return}}(function(e,t){var a=e.trim();return 0===a.length?r.Empty:t.invalidCharactersRegex.test(a)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(a)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(a)?r.InvalidEnd:void 0}(t,e),e)}}!function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(r||(r={}));var c=i({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),s=i({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},e98307e3d02bf06255ee:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("98bae3dbabd51089d613"),n=a("c1a09d7dd35e11297e15"),o=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createSession=function(e){var t=e.qosData,a=e.itemUrl,n=e.headers,o=e.allowCookies,c=e.accessToken,s=e.fileName,u=e.fileSize,d=e.lastModifiedDate,l=e.eTag,f=e.conflictBehavior,m=e.ignoreCookieAuth,p={item:r.__assign({},i(a)?{"@microsoft.graph.conflictBehavior":f}:{"@name.conflictBehavior":f},d?{fileSystemInfo:{lastModifiedDateTime:d.toISOString()}}:{})},b=r.__assign({},l?{"If-Match":l}:{},m?{IgnoreCookieAuthentication:"t"}:{},{Prefer:"synchronousmetadata"},n);return this._dataRequestor.send({path:a+"/"+encodeURIComponent(s)+":/"+(i(a)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:b,allowCookies:o,accessToken:c,useAuthorizationHeaders:!0,postData:JSON.stringify(p),qosExtraData:r.__assign({conflictBehavior:f,fileSize:u},t)})},e.prototype.cancelSession=function(e){var t=e.qosData,a=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:a,needsAuthorization:!1,qosExtraData:t})},e.prototype.uploadFragment=function(e){var t=e.qosData,a=e.headers,o=e.sessionUrl,i=e.startByte,c=e.endByte,s=e.fileSize,u=e.content,d=e.timeout,l=e.onProgress,f=r.__assign({"Content-Range":"bytes "+i+"-"+Math.max(c-1,i)+"/"+s},a),m=!0,p=this._dataRequestor.send({path:o,needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:f,postData:u,timeout:d,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&m&&l(i+e.loaded)},qosExtraData:r.__assign({},t,{startByte:i,endByte:c,fileSize:s})}),b=new n.default((function(){m=!1,p.cancel()}));return p.done((function(e){m=!1,b.complete(e)}),(function(e){m=!1,b.error(e)})),b.getPromise()},e.prototype.commit=function(e){var t=e.qosData,a=e.itemUrl,n=e.accessToken,o=e.fileName,c=(e.description,e.eTag),s=e.conflictBehavior,u=e.sessionUrl,d={"If-Match":c},l=i(a)?{"@microsoft.graph.conflictBehavior":s,"@microsoft.graph.sourceUrl":u}:{"@name.conflictBehavior":s,"@content.sourceUrl":u};return this._dataRequestor.send({path:a+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:d,accessToken:n,useAuthorizationHeaders:!0,postData:JSON.stringify(l),qosExtraData:r.__assign({conflictBehavior:s},t)})},e.prototype.getStatus=function(e){var t=e.qosData,a=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:a,needsAuthorization:!1,qosExtraData:t})},e.prototype.getItem=function(e){var t=e.qosData,a=e.itemUrl,n=e.accessToken,o=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:a+"/"+encodeURIComponent(o),useAuthorizationHeaders:!0,accessToken:n,qosExtraData:r.__assign({},t)})},e}();function i(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}t.UploadService=o},e9c8562c28ece80d4f49:function(e,t,a){"use strict";a.r(t),a.d(t,"createFolderDialogControlHandler",(function(){return u}));var r=a("a4060cda3c9c24220a4a"),n=a("5e76ddf6bb30811ee697"),o=a("fcf654cc44d7ec457fe0"),i=a("ee92087a6ec1d0e9ecc9"),c=a("95da7825c4969f34e250"),s=a("cfef2ab49d0d7bc1e869"),u=Object(c.a)()((function(){return function(e){return function(e,t){var a,c=t.itemKey,u=e.demandItemFacet(r.D,c),d=s.a;if(u&&c){var l=u.rootFolder||new o.SimpleUri(u.listFullUrl).path,f=new n.a({context:{webAbsoluteUrl:u.webAbsoluteUrl,listUrl:u.listFullUrl}}).getUrlParts({path:l});f.fullItemUrl&&(a=400-f.fullItemUrl.length);var m=u&&e.demandItemFacet(i.rc,r.Q.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));!m||m.supportPoundStorePath&&m.supportPercentStorePath||(d=s.b)}return{validator:d,maxLength:a}}}}))},f4ada3c3607c09804e69:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return u}));var r=a("56aac858adc5742217b8"),n=a("a9dd204dd0bee7467912"),o=a("6dec44e5485412f70439"),i=a("a24d70c7702f13f024d9");function c(e,t){var a=t+"/me/drive";return Object(o.f)({url:a,qosName:e,method:"POST",endpoint:t})}function s(e,t,a,r,n){var i=a.itemId,c=a.driveId,s=n.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{id:i||"",parentReference:{driveId:c||""}}};return Object(o.f)({url:s,qosName:r,method:"POST",body:u,endpoint:n})}function u(e){var t=Object(i.getErrorResolution)(e,(function(e,t){switch(e){case"unauthenticated":case 401:return n.b.pack({});case"itemNotFound":case 404:return n.f.pack({});case"accessDenied":case 403:return n.a.pack({});default:return n.m.pack({})}}));throw new r.a({innerError:e,facets:t})}},fcf0c1042bbdc766028e:function(e,t,a){"use strict";a.r(t),a.d(t,"ConfirmationDialog",(function(){return d}));var r=a("275976081ce1abf67779"),n=a("c9764d34b3eb6a106977"),o=a("b0e26fa7634e6889091e"),i=a("8183bb1c55fccc7b597d"),c=a("82a5b752ca799aba4856"),s=a("b1dcd93e69c85f76518a"),u=a("4986dedaa57d766e48bb")._MSLAghTqZZ9UlMeNWvkeGQ,d=function(e){var t=e.onConfirm,a=e.onCancel,d=e.defaultToYes,l=void 0!==d&&d,f=e.yesText,m=void 0===f?u.yes:f,p=e.noText,b=void 0===p?u.no:p,h=l?i.a:c.a,v=l?c.a:i.a;return r.createElement(n.a,{onDismiss:a,isOpen:!0,title:e.title,maxWidth:e.maxWidth},r.createElement(s.a,null,e.prompt),r.createElement(o.a,null,r.createElement(h,{"data-automationid":"confirmbutton",onClick:t},m),r.createElement(v,{"data-automationid":"cancelbutton",onClick:a,componentRef:function(e){e&&e.focus()}},b)))}}}]);